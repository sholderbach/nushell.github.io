import{_ as c,r as p,o as l,c as r,a as n,b as a,w as u,e as t,d as s}from"./app.8034769a.js";const k={},d=t('<h1 id="dataframes" tabindex="-1"><a class="header-anchor" href="#dataframes" aria-hidden="true">#</a> DataFrames</h1><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>DataFrame \u76F8\u5173\u547D\u4EE4\u4ECE 0.33.1 \u7248\u672C\u5F00\u59CB\u652F\u6301</p></div><p>\u6B63\u5982\u6211\u4EEC\u5230\u76EE\u524D\u4E3A\u6B62\u6240\u770B\u5230\u7684\uFF0CNushell \u628A\u6570\u636E\u5904\u7406\u4F5C\u4E3A\u5176\u4E3B\u8981\u4EFB\u52A1\u3002<code>Lists</code> \u548C <code>Tables</code>\u7684\u5B58\u5728\u662F\u4E3A\u4E86\u5E2E\u52A9\u4F60\u5FAA\u73AF\u5904\u7406\u503C\uFF0C\u4EE5\u4FBF\u6267\u884C\u591A\u79CD\u64CD\u4F5C\u6216\u8F7B\u800C\u6613\u4E3E\u5730\u627E\u5230\u6570\u636E\u3002\u7136\u800C\uFF0C\u5728\u67D0\u4E9B\u64CD\u4F5C\u4E2D\uFF0C\u57FA\u4E8E\u884C\u7684\u6570\u636E\u5E03\u5C40\u5E76\u4E0D\u662F\u5904\u7406\u6570\u636E\u7684\u6700\u6709\u6548\u65B9\u5F0F\uFF0C\u7279\u522B\u662F\u5728\u5904\u7406\u6781\u5176\u5E9E\u5927\u7684\u6587\u4EF6\u65F6\u3002\u5BF9\u4E8E\u5927\u578B\u6570\u636E\u96C6\u7684<code>group-by</code>\u6216<code>join</code>\u7B49\u64CD\u4F5C\uFF0C\u5982\u679C\u4E0D\u4F7F\u7528\u9002\u5F53\u7684\u6570\u636E\u683C\u5F0F\uFF0C\u4F1A\u5360\u7528\u5927\u91CF\u7684\u5185\u5B58\uFF0C\u5E76\u53EF\u80FD\u8017\u8D39\u5927\u91CF\u7684\u8BA1\u7B97\u65F6\u95F4\u3002</p>',3),i=s("\u51FA\u4E8E\u8FD9\u4E2A\u539F\u56E0\uFF0CNushell \u5F15\u5165\u4E86"),m=n("code",null,"DataFrame",-1),b=s("\u7ED3\u6784\u3002"),h=n("code",null,"DataFrame",-1),g=s("\u4EE5\u5217\u683C\u5F0F\u5B58\u50A8\u6570\u636E\uFF0C\u4EE5 "),v={href:"https://arrow.apache.org/",target:"_blank",rel:"noopener noreferrer"},_=s("Apache Arrow"),f=s(" \u89C4\u8303\u4E3A\u57FA\u7840\uFF0C\u5E76\u4F7F\u7528 "),D={href:"https://github.com/pola-rs/polars",target:"_blank",rel:"noopener noreferrer"},F=s("Polars"),w=s(" \u4F5C\u4E3A\u6267\u884C\u6781\u5176 "),x={href:"https://h2oai.github.io/db-benchmark/",target:"_blank",rel:"noopener noreferrer"},$=s("\u5FEB\u901F\u5217\u5F0F\u64CD\u4F5C"),y=s(" \u7684\u9A6C\u8FBE\u3002"),q=n("p",null,"\u4F60\u73B0\u5728\u53EF\u80FD\u60F3\u77E5\u9053\u8FD9\u4E2A\u7EC4\u5408\u80FD\u6709\u591A\u5FEB\uFF0C\u4EE5\u53CA\u5B83\u5982\u4F55\u80FD\u4F7F\u6570\u636E\u5DE5\u4F5C\u66F4\u5BB9\u6613\u3001\u66F4\u53EF\u9760\u3002\u51FA\u4E8E\u8FD9\u4E2A\u539F\u56E0\uFF0C\u8BA9\u6211\u4EEC\u5728\u672C\u9875\u5F00\u59CB\u65F6\u4ECB\u7ECD\u4E00\u4E0B\u5904\u7406\u6570\u636E\u65F6\u7684\u5E38\u89C1\u64CD\u4F5C\u7684\u6027\u80FD\u6D4B\u8BD5\u60C5\u51B5\u3002",-1),N=n("h2",{id:"\u6027\u80FD\u6D4B\u8BD5\u5BF9\u6BD4",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u6027\u80FD\u6D4B\u8BD5\u5BF9\u6BD4","aria-hidden":"true"},"#"),s(" \u6027\u80FD\u6D4B\u8BD5\u5BF9\u6BD4")],-1),S=s("\u5728\u8FD9\u4E2A\u5C0F\u7684\u6027\u80FD\u6D4B\u8BD5\u7EC3\u4E60\u4E2D\uFF0C\u6211\u4EEC\u5C06\u6BD4\u8F83\u672C\u5730\u7684 Nushell \u539F\u751F\u547D\u4EE4\u3001Nushell DataFrame \u76F8\u5173\u547D\u4EE4\u548C"),A={href:"https://pandas.pydata.org/",target:"_blank",rel:"noopener noreferrer"},P=s("Python Pandas"),G=s("\u547D\u4EE4\u3002\u6682\u65F6\u4E0D\u8981\u592A\u5728\u610F"),B=n("code",null,"dataframe",-1),T=s("\u547D\u4EE4\uFF0C\u5B83\u4EEC\u5C06\u5728\u672C\u9875\u540E\u9762\u7684\u7AE0\u8282\u4E2D\u89E3\u91CA\u3002"),I=n("blockquote",null,[n("p",null,"\u7CFB\u7EDF\u7EC6\u8282\uFF1A\u672C\u8282\u4ECB\u7ECD\u7684\u6027\u80FD\u6D4B\u8BD5\u662F\u7528\u4E00\u53F0\u914D\u5907 Intel(R) Core(TM) i7-10710U \uFF08CPU @1.10GHz 1.61GHz\uFF09\u548C 16 GB \u5185\u5B58\u7684\u673A\u5668\u8FD0\u884C\u7684\u3002"),n("p",null,"\u6240\u6709\u7684\u4F8B\u5B50\u90FD\u5728 Nushell 0.33.1 \u7248\u672C\u4E0A\u8FD0\u884C\u3002")],-1),z=n("h3",{id:"\u6587\u4EF6\u4FE1\u606F",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u6587\u4EF6\u4FE1\u606F","aria-hidden":"true"},"#"),s(" \u6587\u4EF6\u4FE1\u606F")],-1),M=s("\u6211\u4EEC\u5C06\u7528\u4E8E\u6027\u80FD\u6D4B\u8BD5\u7684\u6587\u4EF6\u662F "),j={href:"https://www.stats.govt.nz/assets/Uploads/New-Zealand-business-demography-statistics/New-Zealand-business-demography-statistics-At-February-2020/Download-data/Geographic-units-by-industry-and-statistical-area-2000-2020-descending-order-CSV.zip",target:"_blank",rel:"noopener noreferrer"},O=s("\u65B0\u897F\u5170\u5546\u4E1A\u4EBA\u53E3\u7EDF\u8BA1"),C=s(" \u6570\u636E\u96C6\u3002 \u5982\u679C\u4F60\u60F3\u5C1D\u8BD5\u8FD9\u4E9B\u6D4B\u8BD5\uFF0C\u8BF7\u4E0B\u8F7D\u8BE5\u6587\u4EF6\u3002"),Y=t(`<p>\u8BE5\u6570\u636E\u96C6\u6709 5 \u5217\uFF0C5,429,252 \u884C\u3002\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7\u4F7F\u7528<code>ls-df</code>\u547D\u4EE4\u6765\u68C0\u67E5\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> <span class="token function">df</span> <span class="token operator">=</span> <span class="token punctuation">(</span>open-df .<span class="token punctuation">\\</span>Data7602DescendingYearOrder.csv<span class="token punctuation">)</span>
<span class="token operator">&gt;</span> ls-df

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 name \u2502  rows   \u2502 columns</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 <span class="token variable">$df</span>  \u2502 <span class="token number">5429252</span> \u2502 <span class="token number">5</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u6211\u4EEC\u53EF\u4EE5\u7528 <code>first</code> \u770B\u4E00\u4E0B\u6587\u4EF6\u7684\u7B2C\u4E00\u884C\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token variable">$df</span> <span class="token operator">|</span> first

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 anzsic06 \u2502  Area   \u2502 year \u2502 geo_count \u2502 ec_count</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 A        \u2502 A100100 \u2502 <span class="token number">2000</span> \u2502        <span class="token number">96</span> \u2502      <span class="token number">130</span>
 <span class="token number">1</span> \u2502 A        \u2502 A100200 \u2502 <span class="token number">2000</span> \u2502       <span class="token number">198</span> \u2502      <span class="token number">110</span>
 <span class="token number">2</span> \u2502 A        \u2502 A100300 \u2502 <span class="token number">2000</span> \u2502        <span class="token number">42</span> \u2502       <span class="token number">25</span>
 <span class="token number">3</span> \u2502 A        \u2502 A100400 \u2502 <span class="token number">2000</span> \u2502        <span class="token number">66</span> \u2502       <span class="token number">40</span>
 <span class="token number">4</span> \u2502 A        \u2502 A100500 \u2502 <span class="token number">2000</span> \u2502        <span class="token number">63</span> \u2502       <span class="token number">40</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>...\u6700\u540E\uFF0C\u6211\u4EEC\u53EF\u4EE5\u4E86\u89E3\u4E00\u4E0B\u63A8\u65AD\u51FA\u7684\u6570\u636E\u7C7B\u578B\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token variable">$df</span> <span class="token operator">|</span> dtypes

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502  column   \u2502 dtype</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 anzsic06  \u2502 str
 <span class="token number">1</span> \u2502 Area      \u2502 str
 <span class="token number">2</span> \u2502 year      \u2502 i64
 <span class="token number">3</span> \u2502 geo_count \u2502 i64
 <span class="token number">4</span> \u2502 ec_count  \u2502 i64
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><h3 id="\u52A0\u8F7D\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u52A0\u8F7D\u6587\u4EF6" aria-hidden="true">#</a> \u52A0\u8F7D\u6587\u4EF6</h3>`,7),L=s("\u8BA9\u6211\u4EEC\u5148\u6765\u6BD4\u8F83\u4E00\u4E0B\u5404\u79CD\u65B9\u6CD5\u7684\u52A0\u8F7D\u65F6\u95F4\u3002\u9996\u5148\uFF0C\u6211\u4EEC\u5C06\u4F7F\u7528 Nushell \u7684"),R=n("code",null,"open",-1),V=s("\u547D\u4EE4\u52A0\u8F7D\u6570\u636E\uFF1A"),E=t(`<div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> benchmark <span class="token punctuation">{</span>open .<span class="token punctuation">\\</span>Data7602DescendingYearOrder.csv<span class="token punctuation">}</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502        real time</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 30sec 479ms 614us 400ns
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u4F7F\u7528\u539F\u751F\u7684 Nushell \u529F\u80FD\u52A0\u8F7D\u6587\u4EF6\u9700\u8981 30 \u79D2\u3002\u5BF9\u4E8E\u52A0\u8F7D 500 \u4E07\u6761\u8BB0\u5F55\u6765\u8BF4\uFF0C\u8FD9\u8FD8\u7B97\u4E0D\u9519\uFF01\u4F46\u6211\u4EEC\u53EF\u4EE5\u505A\u5F97\u66F4\u597D\u4E00\u4E9B\u3002</p><p>\u73B0\u5728\u8BA9\u6211\u4EEC\u4F7F\u7528 Pandas\u3002\u6211\u4EEC\u5C06\u4F7F\u7528\u4EE5\u4E0B\u811A\u672C\u6765\u52A0\u8F7D\u6587\u4EF6\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;Data7602DescendingYearOrder.csv&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p>\u800C\u5B83\u7684\u6027\u80FD\u6D4B\u8BD5\u7ED3\u679C\u662F\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> benchmark <span class="token punctuation">{</span>python load.py<span class="token punctuation">}</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502       real time</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 2sec 91ms 872us 900ns
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u8FD9\u662F\u4E00\u4E2A\u5F88\u5927\u7684\u8FDB\u6B65\uFF0C\u4ECE 30 \u79D2\u5230 2 \u79D2\u3002\u5E72\u5F97\u597D\uFF0CPandas!</p><p>\u4E5F\u8BB8\u6211\u4EEC\u52A0\u8F7D\u6570\u636E\u53EF\u4EE5\u518D\u5FEB\u4E00\u70B9\uFF0C\u8FD9\u4E00\u6B21\u6211\u4EEC\u5C06\u4F7F\u7528 Nushell \u7684 <code>open-df</code> \u547D\u4EE4\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> benchmark <span class="token punctuation">{</span>open-df .<span class="token punctuation">\\</span>Data7602DescendingYearOrder.csv<span class="token punctuation">}</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502     real time</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 601ms 700us 700ns
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u8FD9\u4E00\u6B21\uFF0C\u6211\u4EEC\u82B1\u4E86 0.6 \u79D2\u3002\u4E00\u70B9\u4E5F\u4E0D\u5DEE\u3002</p><h3 id="group-by\u6BD4\u8F83" tabindex="-1"><a class="header-anchor" href="#group-by\u6BD4\u8F83" aria-hidden="true">#</a> <code>Group-by</code>\u6BD4\u8F83</h3><p>\u8FD9\u6B21\u8BA9\u6211\u4EEC\u505A\u4E00\u4E2A\u7A0D\u5FAE\u590D\u6742\u7684\u64CD\u4F5C\u3002\u6211\u4EEC\u5C06\u6309\u5E74\u4EFD\u5BF9\u6570\u636E\u8FDB\u884C\u5206\u7EC4\uFF0C\u5E76\u6839\u636E<code>geo_count</code>\u5217\u5BF9\u5206\u7EC4\u6C42\u548C\u3002</p><p>\u540C\u6837\uFF0C\u6211\u4EEC\u8981\u4ECE Nushell \u7684\u539F\u751F\u547D\u4EE4\u5F00\u59CB\uFF1A</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>\u5982\u679C\u4F60\u60F3\u8FD0\u884C\u8FD9\u4E2A\u4F8B\u5B50\uFF0C\u8BF7\u6CE8\u610F\u63A5\u4E0B\u6765\u7684\u547D\u4EE4\u5C06\u4F7F\u7528\u5927\u91CF\u7684\u5185\u5B58\uFF0C\u5728\u8BE5\u547D\u4EE4\u6267\u884C\u671F\u95F4\u53EF\u80FD\u4F1A\u5F71\u54CD\u4F60\u7684\u7CFB\u7EDF\u6027\u80FD\u3002</p></div><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> benchmark <span class="token punctuation">{</span>
	<span class="token function">open</span> .<span class="token punctuation">\\</span>Data7602DescendingYearOrder.csv
	<span class="token operator">|</span> group-by year
	<span class="token operator">|</span> transpose header rows
	<span class="token operator">|</span> upsert rows <span class="token punctuation">{</span> get rows <span class="token operator">|</span> math <span class="token function">sum</span> <span class="token punctuation">}</span>
	<span class="token operator">|</span> flatten
<span class="token punctuation">}</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502       real time</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 6min 30sec 622ms 312us
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u6240\u4EE5\uFF0C\u6267\u884C\u8FD9\u4E2A\u805A\u5408\u64CD\u4F5C\u9700\u8981 6 \u5206\u949F\u3002</p><p>\u8BA9\u6211\u4EEC\u8BD5\u8BD5\u5728<code>pandas</code>\u4E2D\u8FDB\u884C\u540C\u6837\u7684\u64CD\u4F5C\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;Data7602DescendingYearOrder.csv&quot;</span><span class="token punctuation">)</span>
res <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;year&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&quot;geo_count&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
</code></pre></div><p>\u800C\u6027\u80FD\u6D4B\u8BD5\u7684\u7ED3\u679C\u662F\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> benchmark <span class="token punctuation">{</span>python .<span class="token punctuation">\\</span>load.py<span class="token punctuation">}</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502       real time</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 1sec 966ms 954us 800ns
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u4E00\u70B9\u4E5F\u4E0D\u5DEE\uFF01\u540C\u6837\uFF0CPandas \u8BBE\u6CD5\u5728\u5F88\u77ED\u7684\u65F6\u95F4\u5185\u5B8C\u6210\u4E86\u5B83\u3002</p><p>\u4E3A\u4E86\u8FDB\u884C\u6BD4\u8F83\uFF0C\u8BA9\u6211\u4EEC\u8BD5\u8BD5 Nushell DataFrames\u3002\u6211\u4EEC\u8981\u628A\u6240\u6709\u7684\u64CD\u4F5C\u653E\u5728\u4E00\u4E2A<code>nu</code>\u6587\u4EF6\u4E2D\uFF0C\u4EE5\u786E\u4FDD\u6211\u4EEC\u505A\u7684\u662F\u7C7B\u4F3C\u7684\u64CD\u4F5C\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token builtin class-name">let</span> <span class="token function">df</span> <span class="token operator">=</span> open-df Data7602DescendingYearOrder.csv
<span class="token builtin class-name">let</span> res <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$df</span> <span class="token operator">|</span> group-by year <span class="token operator">|</span> agg <span class="token punctuation">(</span>col geo_count <span class="token operator">|</span> <span class="token function">sum</span><span class="token punctuation">))</span>
<span class="token variable">$res</span>
</code></pre></div><p>\u5F53\u4F7F\u7528 DataFrames \u65F6\u7684\u6027\u80FD\u6D4B\u8BD5\u7ED3\u679C\u662F\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> benchmark <span class="token punctuation">{</span>source load.nu<span class="token punctuation">}</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502     real time</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 557ms 658us 500ns
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u5E78\u8FD0\u7684\u662F\uFF0CNushell DataFrame \u8BBE\u6CD5\u5C06\u65F6\u95F4\u518D\u6B21\u51CF\u534A\u3002\u8FD9\u4E0D\u662F\u5F88\u597D\u5417\uFF1F</p><p>\u6B63\u5982\u4F60\u6240\u770B\u5230\u7684\uFF0CNushell \u7684<code>DataFrame</code>\u547D\u4EE4\u548C\u73B0\u5728\u6700\u5E38\u89C1\u7684\u505A\u6570\u636E\u5206\u6790\u7684\u5DE5\u5177\u4E00\u6837\u5FEB\u3002\u8FD9\u4E2A\u53D1\u884C\u7248\u4E2D\u7684\u547D\u4EE4\u6709\u53EF\u80FD\u6210\u4E3A\u4F60\u505A\u6570\u636E\u5206\u6790\u7684\u9996\u9009\u5DE5\u5177\u3002\u901A\u8FC7\u7EC4\u5408\u590D\u6742\u7684 Nushell \u7BA1\u9053\uFF0C\u4F60\u53EF\u4EE5\u4EE5\u4E00\u79CD\u53EF\u9760\u7684\u65B9\u5F0F\u4ECE\u6570\u636E\u4E2D\u63D0\u53D6\u4FE1\u606F\u3002</p><h2 id="\u4F7F\u7528-dataframes" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528-dataframes" aria-hidden="true">#</a> \u4F7F\u7528 DataFrames</h2><p>\u5728\u770B\u5230\u4E86\u53EF\u4EE5\u7528<code>DataFrame</code>\u547D\u4EE4\u5B8C\u6210\u7684\u4E8B\u60C5\u4E4B\u540E\uFF0C\u73B0\u5728\u662F\u65F6\u5019\u5F00\u59CB\u6D4B\u8BD5\u5B83\u4EEC\u4E86\u3002\u9996\u5148\uFF0C\u8BA9\u6211\u4EEC\u521B\u5EFA\u4E00\u4E2A\u6837\u672C CSV \u6587\u4EF6\uFF0C\u8BE5\u6587\u4EF6\u5C06\u6210\u4E3A\u6211\u4EEC\u7684\u6837\u672C DataFrame\uFF0C\u5E76\u4E0E\u793A\u4F8B\u4E00\u8D77\u4F7F\u7528\u3002\u5728\u4F60\u559C\u6B22\u7684\u7F16\u8F91\u5668\u4E2D\u7C98\u8D34\u4E0B\u9762\u51E0\u884C\u6765\u521B\u5EFA\u6837\u672C csv \u6587\u4EF6\uFF1A</p><div class="language-csv ext-csv"><pre class="language-csv"><code><span class="token value">int_1</span><span class="token punctuation">,</span><span class="token value">int_2</span><span class="token punctuation">,</span><span class="token value">float_1</span><span class="token punctuation">,</span><span class="token value">float_2</span><span class="token punctuation">,</span><span class="token value">first</span><span class="token punctuation">,</span><span class="token value">second</span><span class="token punctuation">,</span><span class="token value">third</span><span class="token punctuation">,</span><span class="token value">word</span>
<span class="token value">1</span><span class="token punctuation">,</span><span class="token value">11</span><span class="token punctuation">,</span><span class="token value">0.1</span><span class="token punctuation">,</span><span class="token value">1.0</span><span class="token punctuation">,</span><span class="token value">a</span><span class="token punctuation">,</span><span class="token value">b</span><span class="token punctuation">,</span><span class="token value">c</span><span class="token punctuation">,</span><span class="token value">first</span>
<span class="token value">2</span><span class="token punctuation">,</span><span class="token value">12</span><span class="token punctuation">,</span><span class="token value">0.2</span><span class="token punctuation">,</span><span class="token value">1.0</span><span class="token punctuation">,</span><span class="token value">a</span><span class="token punctuation">,</span><span class="token value">b</span><span class="token punctuation">,</span><span class="token value">c</span><span class="token punctuation">,</span><span class="token value">second</span>
<span class="token value">3</span><span class="token punctuation">,</span><span class="token value">13</span><span class="token punctuation">,</span><span class="token value">0.3</span><span class="token punctuation">,</span><span class="token value">2.0</span><span class="token punctuation">,</span><span class="token value">a</span><span class="token punctuation">,</span><span class="token value">b</span><span class="token punctuation">,</span><span class="token value">c</span><span class="token punctuation">,</span><span class="token value">third</span>
<span class="token value">4</span><span class="token punctuation">,</span><span class="token value">14</span><span class="token punctuation">,</span><span class="token value">0.4</span><span class="token punctuation">,</span><span class="token value">3.0</span><span class="token punctuation">,</span><span class="token value">b</span><span class="token punctuation">,</span><span class="token value">a</span><span class="token punctuation">,</span><span class="token value">c</span><span class="token punctuation">,</span><span class="token value">second</span>
<span class="token value">0</span><span class="token punctuation">,</span><span class="token value">15</span><span class="token punctuation">,</span><span class="token value">0.5</span><span class="token punctuation">,</span><span class="token value">4.0</span><span class="token punctuation">,</span><span class="token value">b</span><span class="token punctuation">,</span><span class="token value">a</span><span class="token punctuation">,</span><span class="token value">a</span><span class="token punctuation">,</span><span class="token value">third</span>
<span class="token value">6</span><span class="token punctuation">,</span><span class="token value">16</span><span class="token punctuation">,</span><span class="token value">0.6</span><span class="token punctuation">,</span><span class="token value">5.0</span><span class="token punctuation">,</span><span class="token value">b</span><span class="token punctuation">,</span><span class="token value">a</span><span class="token punctuation">,</span><span class="token value">a</span><span class="token punctuation">,</span><span class="token value">second</span>
<span class="token value">7</span><span class="token punctuation">,</span><span class="token value">17</span><span class="token punctuation">,</span><span class="token value">0.7</span><span class="token punctuation">,</span><span class="token value">6.0</span><span class="token punctuation">,</span><span class="token value">b</span><span class="token punctuation">,</span><span class="token value">c</span><span class="token punctuation">,</span><span class="token value">a</span><span class="token punctuation">,</span><span class="token value">third</span>
<span class="token value">8</span><span class="token punctuation">,</span><span class="token value">18</span><span class="token punctuation">,</span><span class="token value">0.8</span><span class="token punctuation">,</span><span class="token value">7.0</span><span class="token punctuation">,</span><span class="token value">c</span><span class="token punctuation">,</span><span class="token value">c</span><span class="token punctuation">,</span><span class="token value">b</span><span class="token punctuation">,</span><span class="token value">eight</span>
<span class="token value">9</span><span class="token punctuation">,</span><span class="token value">19</span><span class="token punctuation">,</span><span class="token value">0.9</span><span class="token punctuation">,</span><span class="token value">8.0</span><span class="token punctuation">,</span><span class="token value">c</span><span class="token punctuation">,</span><span class="token value">c</span><span class="token punctuation">,</span><span class="token value">b</span><span class="token punctuation">,</span><span class="token value">ninth</span>
<span class="token value">0</span><span class="token punctuation">,</span><span class="token value">10</span><span class="token punctuation">,</span><span class="token value">0.0</span><span class="token punctuation">,</span><span class="token value">9.0</span><span class="token punctuation">,</span><span class="token value">c</span><span class="token punctuation">,</span><span class="token value">c</span><span class="token punctuation">,</span><span class="token value">b</span><span class="token punctuation">,</span><span class="token value">ninth</span>
</code></pre></div><p>\u4FDD\u5B58\u8BE5\u6587\u4EF6\u5E76\u968F\u610F\u547D\u540D\uFF0C\u5728\u8FD9\u4E9B\u4F8B\u5B50\u4E2D\uFF0C\u8BE5\u6587\u4EF6\u5C06\u88AB\u79F0\u4E3A <code>test_small.csv</code>\u3002</p><p>\u73B0\u5728\uFF0C\u8981\u5C06\u8BE5\u6587\u4EF6\u4F5C\u4E3A DataFrame \u8FDB\u884C\u8BFB\u53D6\uFF0C\u8BF7\u4F7F\u7528 <code>open-df</code> \u547D\u4EE4\uFF0C\u5982\u4E0B\u6240\u793A\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> <span class="token function">df</span> <span class="token operator">=</span> open-df test_small.csv
</code></pre></div><p>\u8FD9\u5E94\u8BE5\u4F1A\u5728\u5185\u5B58\u4E2D\u521B\u5EFA\u4E00\u4E2A\u503C <code>$df</code>\uFF0C\u7528\u6765\u5B58\u653E\u6211\u4EEC\u521A\u521A\u521B\u5EFA\u7684\u6570\u636E\u3002</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p><code>open-df</code> \u547D\u4EE4\u53EF\u4EE5\u8BFB\u53D6 <strong>csv</strong> \u6216 <strong>parquet</strong> \u6587\u4EF6\u3002</p></div><p>\u8981\u67E5\u770B\u5B58\u50A8\u5728\u5185\u5B58\u4E2D\u7684\u6240\u6709 DataFrames\uFF0C\u4F60\u53EF\u4EE5\u4F7F\u7528\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> ls-df

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 name \u2502 rows \u2502 columns</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 <span class="token variable">$df</span>  \u2502 <span class="token number">10</span>   \u2502 <span class="token number">8</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u6B63\u5982\u4F60\u6240\u770B\u5230\u7684\uFF0C\u8BE5\u547D\u4EE4\u663E\u793A\u4E86\u6240\u521B\u5EFA\u7684 DataFrame \u4EE5\u53CA\u5173\u4E8E\u5B83\u4EEC\u7684\u57FA\u672C\u4FE1\u606F\u3002</p><p>\u5982\u679C\u4F60\u60F3\u770B\u5230\u52A0\u8F7D\u7684 DataFrame \u7684\u9884\u89C8\uFF0C\u4F60\u53EF\u4EE5\u5C06 DataFrame \u53D8\u91CF\u53D1\u9001\u5230\u6D41\u4E2D\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token variable">$df</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 int_1 \u2502 int_2 \u2502 float_1 \u2502 float_2 \u2502 first \u2502 second \u2502 third \u2502  word</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502     <span class="token number">1</span> \u2502    <span class="token number">11</span> \u2502  <span class="token number">0.1000</span> \u2502  <span class="token number">1.0000</span> \u2502 a     \u2502 b      \u2502 c     \u2502 first
 <span class="token number">1</span> \u2502     <span class="token number">2</span> \u2502    <span class="token number">12</span> \u2502  <span class="token number">0.2000</span> \u2502  <span class="token number">1.0000</span> \u2502 a     \u2502 b      \u2502 c     \u2502 second
 <span class="token number">2</span> \u2502     <span class="token number">3</span> \u2502    <span class="token number">13</span> \u2502  <span class="token number">0.3000</span> \u2502  <span class="token number">2.0000</span> \u2502 a     \u2502 b      \u2502 c     \u2502 third
 <span class="token number">3</span> \u2502     <span class="token number">4</span> \u2502    <span class="token number">14</span> \u2502  <span class="token number">0.4000</span> \u2502  <span class="token number">3.0000</span> \u2502 b     \u2502 a      \u2502 c     \u2502 second
 <span class="token number">4</span> \u2502     <span class="token number">0</span> \u2502    <span class="token number">15</span> \u2502  <span class="token number">0.5000</span> \u2502  <span class="token number">4.0000</span> \u2502 b     \u2502 a      \u2502 a     \u2502 third
 <span class="token number">5</span> \u2502     <span class="token number">6</span> \u2502    <span class="token number">16</span> \u2502  <span class="token number">0.6000</span> \u2502  <span class="token number">5.0000</span> \u2502 b     \u2502 a      \u2502 a     \u2502 second
 <span class="token number">6</span> \u2502     <span class="token number">7</span> \u2502    <span class="token number">17</span> \u2502  <span class="token number">0.7000</span> \u2502  <span class="token number">6.0000</span> \u2502 b     \u2502 c      \u2502 a     \u2502 third
 <span class="token number">7</span> \u2502     <span class="token number">8</span> \u2502    <span class="token number">18</span> \u2502  <span class="token number">0.8000</span> \u2502  <span class="token number">7.0000</span> \u2502 c     \u2502 c      \u2502 b     \u2502 eight
 <span class="token number">8</span> \u2502     <span class="token number">9</span> \u2502    <span class="token number">19</span> \u2502  <span class="token number">0.9000</span> \u2502  <span class="token number">8.0000</span> \u2502 c     \u2502 c      \u2502 b     \u2502 ninth
 <span class="token number">9</span> \u2502     <span class="token number">0</span> \u2502    <span class="token number">10</span> \u2502  <span class="token number">0.0000</span> \u2502  <span class="token number">9.0000</span> \u2502 c     \u2502 c      \u2502 b     \u2502 ninth
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u6709\u4E86\u5185\u5B58\u4E2D\u7684 DataFrame\uFF0C\u6211\u4EEC\u5C31\u53EF\u4EE5\u5F00\u59CB\u5BF9 <code>DataFrame</code> \u8FDB\u884C\u5217\u64CD\u4F5C\u3002</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>\u5982\u679C\u4F60\u60F3\u770B\u5230\u6240\u6709\u53EF\u7528\u7684 DataFrame \u547D\u4EE4\uFF0C\u4F60\u53EF\u4EE5\u4F7F\u7528 <code>$nu.scope.commands | where category =~ dataframe</code>\u3002</p></div><h2 id="\u57FA\u672C\u805A\u5408" tabindex="-1"><a class="header-anchor" href="#\u57FA\u672C\u805A\u5408" aria-hidden="true">#</a> \u57FA\u672C\u805A\u5408</h2><p>\u8BA9\u6211\u4EEC\u4ECE DataFrame \u7684\u57FA\u672C\u805A\u5408\u5F00\u59CB\uFF0C\u901A\u8FC7\u4F7F\u7528<code>aggregate</code>\u547D\u4EE4\u5BF9<code>df</code>\u4E2D\u5B58\u5728\u7684\u6240\u6709\u5217\u8FDB\u884C\u6C42\u548C\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token variable">$df</span> <span class="token operator">|</span> <span class="token function">sum</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 int_1 \u2502 int_2 \u2502 float_1 \u2502 float_2 \u2502 first \u2502 second \u2502 third \u2502 word</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502    <span class="token number">40</span> \u2502   <span class="token number">145</span> \u2502  <span class="token number">4.5000</span> \u2502 <span class="token number">46.0000</span> \u2502       \u2502        \u2502       \u2502
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u6B63\u5982\u4F60\u6240\u770B\u5230\u7684\uFF0C\u805A\u5408\u51FD\u6570(<code>aggregate</code>)\u4E3A\u90A3\u4E9B\u6709\u610F\u4E49\u7684\u5217\u8BA1\u7B97\u51FA\u4E86\u603B\u548C\u3002\u5982\u679C\u4F60\u60F3\u8FC7\u6EE4\u6389\u6587\u672C\u5217\uFF0C\u4F60\u53EF\u4EE5\u4F7F\u7528<code>select</code>\u547D\u4EE4\u6765\u9009\u62E9\u4F60\u60F3\u8981\u7684\u5217\u3002</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token variable">$df</span> <span class="token operator">|</span> <span class="token function">sum</span> <span class="token operator">|</span> <span class="token keyword">select</span> int_1 int_2 float_1 float_2

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 int_1 \u2502 int_2 \u2502 float_1 \u2502 float_2</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502    <span class="token number">40</span> \u2502   <span class="token number">145</span> \u2502  <span class="token number">4.5000</span> \u2502 <span class="token number">46.0000</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u4F60\u751A\u81F3\u53EF\u4EE5\u50CF\u5B58\u50A8\u4EFB\u4F55\u5176\u4ED6 Nushell \u53D8\u91CF\u4E00\u6837\u5B58\u50A8\u8FD9\u4E2A\u805A\u5408\u7684\u7ED3\u679C\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> res <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$df</span> <span class="token operator">|</span> <span class="token function">sum</span> <span class="token operator">|</span> <span class="token keyword">select</span> int_1 int_2 float_1 float_2<span class="token punctuation">)</span>
</code></pre></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>\u8F93\u5165 <code>let res = ( !! )</code> \u5E76\u6309\u56DE\u8F66\uFF0C\u8FD9\u5C06\u81EA\u52A8\u5B8C\u6210\u4E4B\u524D\u6267\u884C\u7684\u547D\u4EE4\u3002\u6CE8\u610F ( \u548C !! \u4E4B\u95F4\u7684\u7A7A\u683C\u3002</p></div><p>\u73B0\u5728\u6211\u4EEC\u6709\u4E24\u4E2A DataFrame \u5B58\u50A8\u5728\u5185\u5B58\u4E2D\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> ls-df

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 name \u2502 rows \u2502 columns</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 <span class="token variable">$df</span>  \u2502 <span class="token number">10</span>   \u2502 <span class="token number">8</span>
 <span class="token number">1</span> \u2502 <span class="token variable">$res</span> \u2502 <span class="token number">1</span>    \u2502 <span class="token number">4</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u5F88\u6574\u6D01\uFF0C\u4E0D\u662F\u5417\uFF1F</p><p>\u4F60\u53EF\u4EE5\u5728 DataFrame \u4E0A\u8FDB\u884C\u82E5\u5E72\u805A\u5408\uFF0C\u4EE5\u4FBF\u4ECE\u4E2D\u63D0\u53D6\u57FA\u672C\u4FE1\u606F\uFF0C\u4E5F\u53EF\u4EE5\u5BF9\u4F60\u7684\u5168\u65B0 DataFrame \u8FDB\u884C\u57FA\u672C\u6570\u636E\u5206\u6790\u3002</p><h2 id="\u8FDE\u63A5-dataframe" tabindex="-1"><a class="header-anchor" href="#\u8FDE\u63A5-dataframe" aria-hidden="true">#</a> \u8FDE\u63A5 DataFrame</h2><p>\u4E5F\u53EF\u4EE5\u7528\u4E00\u4E2A\u5217\u4F5C\u4E3A\u53C2\u8003\u6765\u8FDE\u63A5(<code>join</code>)\u4E24\u4E2A DataFrame\u3002\u6211\u4EEC\u5C06\u628A\u6211\u4EEC\u7684\u8FF7\u4F60 DataFrame \u4E0E\u53E6\u4E00\u4E2A\u8FF7\u4F60 DataFrame \u8FDE\u63A5\u8D77\u6765\u3002\u5728\u53E6\u4E00\u4E2A\u6587\u4EF6\u4E2D\u590D\u5236\u8FD9\u4E9B\u884C\uFF0C\u5E76\u521B\u5EFA\u76F8\u5E94\u7684 DataFrame\uFF08\u5728\u4EE5\u4E0B\u4F8B\u5B50\u4E2D\uFF0C\u6211\u4EEC\u5C06\u79F0\u4E4B\u4E3A<code>test_small_a.csv</code>\uFF09\u3002</p><div class="language-text ext-text"><pre class="language-text"><code>int_1,int_2,float_1,float_2,first
9,14,0.4,3.0,a
8,13,0.3,2.0,a
7,12,0.2,1.0,a
6,11,0.1,0.0,b
</code></pre></div><p>\u6211\u4EEC\u4F7F\u7528 <code>open-df</code> \u547D\u4EE4\u6765\u521B\u5EFA\u65B0\u7684\u53D8\u91CF\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> df_a <span class="token operator">=</span> open-df test_small_a.csv
</code></pre></div><p>\u73B0\u5728\uFF0C\u5F53\u7B2C\u4E8C\u4E2A DataFrame \u52A0\u8F7D\u5230\u5185\u5B58\u4E2D\u65F6\uFF0C\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528\u5DE6\u8FB9 DataFrame \u7684<code>int_1</code>\u5217\u548C\u53F3\u8FB9 DataFrame \u7684<code>int_1</code>\u5217\u6765\u8FDE\u63A5\u5B83\u4EEC\u3002</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token variable">$df</span> <span class="token operator">|</span> <span class="token function">join</span> <span class="token variable">$df_a</span> int_1 int_1

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 int_1 \u2502 int_2 \u2502 float_1 \u2502 float_2 \u2502 first \u2502 second \u2502 third \u2502  word   \u2502 int_2_right \u2502 float_1_right \u2502 float_2_right \u2502 first_right</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502     <span class="token number">6</span> \u2502    <span class="token number">16</span> \u2502  <span class="token number">0.6000</span> \u2502  <span class="token number">5.0000</span> \u2502 b     \u2502 a      \u2502 a     \u2502 second  \u2502          <span class="token number">11</span> \u2502        <span class="token number">0.1000</span> \u2502        <span class="token number">0.0000</span> \u2502 b
 <span class="token number">1</span> \u2502     <span class="token number">7</span> \u2502    <span class="token number">17</span> \u2502  <span class="token number">0.7000</span> \u2502  <span class="token number">6.0000</span> \u2502 b     \u2502 c      \u2502 a     \u2502 third   \u2502          <span class="token number">12</span> \u2502        <span class="token number">0.2000</span> \u2502        <span class="token number">1.0000</span> \u2502 a
 <span class="token number">2</span> \u2502     <span class="token number">8</span> \u2502    <span class="token number">18</span> \u2502  <span class="token number">0.8000</span> \u2502  <span class="token number">7.0000</span> \u2502 c     \u2502 c      \u2502 b     \u2502 eight   \u2502          <span class="token number">13</span> \u2502        <span class="token number">0.3000</span> \u2502        <span class="token number">2.0000</span> \u2502 a
 <span class="token number">3</span> \u2502     <span class="token number">9</span> \u2502    <span class="token number">19</span> \u2502  <span class="token number">0.9000</span> \u2502  <span class="token number">8.0000</span> \u2502 c     \u2502 c      \u2502 b     \u2502 ninth   \u2502          <span class="token number">14</span> \u2502        <span class="token number">0.4000</span> \u2502        <span class="token number">3.0000</span> \u2502 a
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>\u5728<code>Nu</code>\u4E2D\uFF0C\u5F53\u4E00\u4E2A\u547D\u4EE4\u6709\u591A\u4E2A\u53C2\u6570\uFF0C\u5E76\u671F\u671B\u5F97\u5230\u591A\u4E2A\u503C\u65F6\uFF0C\u6211\u4EEC\u7528\u65B9\u62EC\u53F7<code>[]</code>\u6765\u5305\u88F9\u8FD9\u4E9B\u503C\u3002\u5728<code>join</code>\u7684\u60C5\u51B5\u4E0B\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5BF9\u591A\u4E2A\u5217\u8FDB\u884C\u8FDE\u63A5\uFF0C\u53EA\u8981\u5B83\u4EEC\u5177\u6709\u76F8\u540C\u7684\u7C7B\u578B\uFF0C\u4F8B\u5982\u6211\u4EEC\u53EF\u4EE5\u8FD9\u6837\u505A\uFF1A<code>$df | join $df_a [int_1 int_2] [int_1 int_2]</code>\u3002</p></div><p>\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u8FDE\u63A5\u547D\u4EE4\u505A\u7684\u662F\u5185\u8FDE\u63A5\uFF0C\u4E5F\u5C31\u662F\u8BF4\uFF0C\u5B83\u5C06\u4FDD\u7559\u4E24\u4E2A DataFrame \u90FD\u6709\u76F8\u540C\u503C\u7684\u8BB0\u5F55\u3002\u4F60\u53EF\u4EE5\u9009\u62E9\u4E00\u4E2A\u5DE6\u8054\u63A5\u6765\u4FDD\u7559\u5DE6\u8FB9 DataFrame \u4E2D\u7F3A\u5931\u7684\u884C\u3002\u4F60\u4E5F\u53EF\u4EE5\u4FDD\u5B58\u8FD9\u4E2A\u7ED3\u679C\uFF0C\u4EE5\u4FBF\u5728\u4EE5\u540E\u7684\u64CD\u4F5C\u4E2D\u4F7F\u7528\u5B83\u3002</p><h2 id="dataframe-\u5206\u7EC4" tabindex="-1"><a class="header-anchor" href="#dataframe-\u5206\u7EC4" aria-hidden="true">#</a> DataFrame \u5206\u7EC4</h2><p>\u53EF\u4EE5\u7528 DataFrame \u8FDB\u884C\u7684\u6700\u5F3A\u5927\u7684\u64CD\u4F5C\u4E4B\u4E00\u662F<code>group-by</code>\u3002\u8FD9\u4E2A\u547D\u4EE4\u5C06\u5141\u8BB8\u4F60\u6839\u636E\u4E00\u4E2A\u5206\u7EC4\u6761\u4EF6\u8FDB\u884C\u805A\u5408\u64CD\u4F5C\u3002\u5728 Nushell \u4E2D\uFF0C<code>GroupBy</code>\u662F\u4E00\u79CD\u53EF\u4EE5\u88AB\u5B58\u50A8\u548C\u91CD\u590D\u4F7F\u7528\u7684\u5BF9\u8C61\uFF0C\u53EF\u4EE5\u88AB\u7528\u4E8E\u591A\u4E2A\u805A\u5408\u3002\u8FD9\u662F\u5F88\u65B9\u4FBF\u7684\uFF0C\u56E0\u4E3A\u5728\u8FDB\u884C\u5206\u7EC4\u65F6\uFF0C\u521B\u5EFA\u5206\u7EC4\u5BF9\u662F\u6700\u6602\u8D35\u7684\u8FD0\u7B97\uFF0C\u5982\u679C\u4F60\u6253\u7B97\u7528\u540C\u4E00\u4E2A\u5206\u7EC4\u6761\u4EF6\u8FDB\u884C\u591A\u4E2A\u64CD\u4F5C\uFF0C\u5C31\u6CA1\u6709\u5FC5\u8981\u91CD\u590D\u8BE5\u8FD0\u7B97\u3002</p><p>\u8981\u521B\u5EFA\u4E00\u4E2A<code>GroupBy</code>\u5BF9\u8C61\uFF0C\u4F60\u53EA\u9700\u8981\u4F7F\u7528<code>group-by</code>\u547D\u4EE4\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> group <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$df</span> <span class="token operator">|</span> group-by first<span class="token punctuation">)</span>
<span class="token operator">&gt;</span> <span class="token variable">$group</span>

 LazyGroupBy \u2502 apply aggregation to complete execution plan
</code></pre></div><p>\u5F53\u6253\u5370 <code>GroupBy</code> \u5BF9\u8C61\u65F6\uFF0C\u6211\u4EEC\u53EF\u4EE5\u770B\u5230\u5B83\u5728\u540E\u53F0\u662F\u4E00\u4E2A\u61D2\u60F0\u7684\u64CD\u4F5C\uFF0C\u7B49\u5F85\u7740\u901A\u8FC7\u6DFB\u52A0\u4E00\u4E2A\u805A\u5408\u6765\u5B8C\u6210\u3002\u4F7F\u7528 <code>GroupBy</code> \u6211\u4EEC\u53EF\u4EE5\u5728\u4E00\u4E2A\u5217\u4E0A\u521B\u5EFA\u805A\u5408</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token variable">$group</span> <span class="token operator">|</span> agg <span class="token punctuation">(</span>col int_1 <span class="token operator">|</span> <span class="token function">sum</span><span class="token punctuation">)</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C
 <span class="token comment"># \u2502 first \u2502 int_1     \u2502</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C
 <span class="token number">0</span> \u2502 a     \u2502         <span class="token number">6</span> \u2502
 <span class="token number">1</span> \u2502 b     \u2502        <span class="token number">17</span> \u2502
 <span class="token number">2</span> \u2502 c     \u2502        <span class="token number">17</span> \u2502
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534
</code></pre></div><p>\u6216\u8005\u6211\u4EEC\u53EF\u4EE5\u5728\u76F8\u540C\u6216\u4E0D\u540C\u7684\u5217\u4E0A\u5B9A\u4E49\u591A\u4E2A\u805A\u5408\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token variable">$group</span> <span class="token operator">|</span> agg <span class="token punctuation">[</span>
	<span class="token punctuation">(</span>col int_1 <span class="token operator">|</span> n-unique<span class="token punctuation">)</span>
	<span class="token punctuation">(</span>col int_2 <span class="token operator">|</span> min<span class="token punctuation">)</span>
	<span class="token punctuation">(</span>col float_1 <span class="token operator">|</span> <span class="token function">sum</span><span class="token punctuation">)</span>
	<span class="token punctuation">(</span>col float_2 <span class="token operator">|</span> count<span class="token punctuation">)</span>
<span class="token punctuation">]</span> <span class="token operator">|</span> sort-by first

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 first \u2502 int_1     \u2502 int_2     \u2502 float_1     \u2502 float_2</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 a     \u2502         <span class="token number">3</span> \u2502        <span class="token number">11</span> \u2502      <span class="token number">0.6000</span> \u2502      <span class="token number">3</span>
 <span class="token number">1</span> \u2502 b     \u2502         <span class="token number">4</span> \u2502        <span class="token number">14</span> \u2502      <span class="token number">2.2000</span> \u2502      <span class="token number">4</span>
 <span class="token number">2</span> \u2502 c     \u2502         <span class="token number">3</span> \u2502        <span class="token number">10</span> \u2502      <span class="token number">1.7000</span> \u2502      <span class="token number">3</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u6B63\u5982\u4F60\u6240\u770B\u5230\u7684\uFF0C<code>GroupBy</code>\u5BF9\u8C61\u662F\u4E00\u4E2A\u975E\u5E38\u5F3A\u5927\u7684\u53D8\u91CF\uFF0C\u5728\u4F60\u64CD\u4F5C\u6570\u636E\u96C6\u65F6\uFF0C\u5B83\u503C\u5F97\u88AB\u4FDD\u7559\u5728\u5185\u5B58\u4E2D\u3002</p><h2 id="\u521B\u5EFA-dataframes" tabindex="-1"><a class="header-anchor" href="#\u521B\u5EFA-dataframes" aria-hidden="true">#</a> \u521B\u5EFA DataFrames</h2><p>\u4E5F\u53EF\u4EE5\u4ECE\u57FA\u672C\u7684 Nushell \u57FA\u7840\u7C7B\u578B\uFF0C\u5982\u6574\u6570\u3001\u5C0F\u6570\u6216\u5B57\u7B26\u4E32\uFF0C\u6765\u6784\u5EFA DataFrames\u3002\u8BA9\u6211\u4EEC\u4F7F\u7528 <code>into df</code> \u547D\u4EE4\u6765\u521B\u5EFA\u4E00\u4E2A\u5C0F\u7684 DataFrame\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span>a b<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">[</span><span class="token number">1</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">3</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">5</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">|</span> into <span class="token function">df</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> <span class="token variable">$a</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u252C\u2500\u2500\u2500
 <span class="token comment"># \u2502 b \u2502 a</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u253C\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 <span class="token number">2</span> \u2502 <span class="token number">1</span>
 <span class="token number">1</span> \u2502 <span class="token number">4</span> \u2502 <span class="token number">3</span>
 <span class="token number">2</span> \u2502 <span class="token number">6</span> \u2502 <span class="token number">5</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500
</code></pre></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>\u76EE\u524D\uFF0C\u5E76\u4E0D\u662F\u6240\u6709\u7684 Nushell \u57FA\u672C\u7C7B\u578B\u90FD\u53EF\u4EE5\u8F6C\u6362\u4E3A DataFrame\u3002\u968F\u7740 DataFrame \u529F\u80FD\u7684\u6210\u719F\uFF0C\u8FD9\u4E00\u70B9\u5C06\u5728\u672A\u6765\u53D1\u751F\u53D8\u5316\u3002</p></div><p>\u6211\u4EEC\u53EF\u4EE5\u5728\u4E00\u4E2A DataFrame \u4E2D\u6DFB\u52A0\u5217\uFF0C\u4EE5\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\u53D8\u91CF\u3002\u4F5C\u4E3A\u4E00\u4E2A\u4F8B\u5B50\uFF0C\u8BA9\u6211\u4EEC\u5728\u8FF7\u4F60 DataFrame <code>$a</code> \u4E0A\u6DFB\u52A0\u4E24\u5217\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> a2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token operator">|</span> with-column <span class="token variable">$a</span>.a <span class="token parameter variable">--name</span> a2 <span class="token operator">|</span> with-column <span class="token variable">$a</span>.a <span class="token parameter variable">--name</span> a3<span class="token punctuation">)</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 b \u2502 a \u2502 a2 \u2502 a3</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 <span class="token number">2</span> \u2502 <span class="token number">1</span> \u2502  <span class="token number">1</span> \u2502  <span class="token number">1</span>
 <span class="token number">1</span> \u2502 <span class="token number">4</span> \u2502 <span class="token number">3</span> \u2502  <span class="token number">3</span> \u2502  <span class="token number">3</span>
 <span class="token number">2</span> \u2502 <span class="token number">6</span> \u2502 <span class="token number">5</span> \u2502  <span class="token number">5</span> \u2502  <span class="token number">5</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500
</code></pre></div><p>Nushell \u5F3A\u5927\u7684\u7BA1\u9053\u8BED\u6CD5\u5141\u8BB8\u6211\u4EEC\u901A\u8FC7\u4ECE\u5176\u4ED6 DataFrame \u4E2D\u83B7\u53D6\u6570\u636E\u5E76\u5C06\u5176\u9644\u52A0\u5230\u8FD9\u4E9B DataFrame \u4E2D\u6765\u521B\u5EFA\u65B0\u7684 DataFrame\u3002\u73B0\u5728\uFF0C\u5982\u679C\u4F60\u5217\u51FA\u4F60\u7684 DataFrame\uFF0C\u4F60\u4F1A\u770B\u5230\u603B\u5171\u6709\u56DB\u4E2A\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> ls-df

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502  name \u2502 rows \u2502 columns</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 <span class="token variable">$a</span>    \u2502 <span class="token number">3</span>    \u2502 <span class="token number">2</span>
 <span class="token number">1</span> \u2502 <span class="token variable">$a2</span>   \u2502 <span class="token number">3</span>    \u2502 <span class="token number">4</span>
 <span class="token number">2</span> \u2502 <span class="token variable">$df_a</span> \u2502 <span class="token number">4</span>    \u2502 <span class="token number">5</span>
 <span class="token number">3</span> \u2502 <span class="token variable">$df</span>   \u2502 <span class="token number">10</span>   \u2502 <span class="token number">8</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div>`,80),U=s("\u503C\u5F97\u4E00\u63D0\u7684\u662F\uFF0C\u5728\u4F7F\u7528 DataFrame \u65F6\uFF0C\u5185\u5B58\u662F\u5982\u4F55\u88AB\u4F18\u5316\u7684\u5462\uFF1F\u8FD9\u8981\u611F\u8C22 "),H=n("strong",null,"Apache Arrow",-1),Z=s(" \u548C "),J=n("strong",null,"Polars",-1),K=s("\u3002\u5728\u4E00\u4E2A\u975E\u5E38\u7B80\u5355\u7684\u8868\u793A\u4E2D\uFF0CDataFrame \u4E2D\u7684\u6BCF\u4E00\u5217\u90FD\u662F\u4E00\u4E2A Arrow \u6570\u7EC4\uFF0C\u5B83\u4F7F\u7528\u4E86\u51E0\u79CD\u5185\u5B58\u89C4\u683C\uFF0C\u4EE5\u585E\u6EE1\u5C3D\u53EF\u80FD\u591A\u7684\u6570\u636E\uFF08\u67E5\u770B "),Q={href:"https://arrow.apache.org/docs/format/Columnar.html",target:"_blank",rel:"noopener noreferrer"},W=s("Arrow \u5217\u683C\u5F0F"),X=s(" \uFF09\uFF1B\u53E6\u4E00\u4E2A\u4F18\u5316\u6280\u5DE7\u662F\uFF0C\u53EA\u8981\u6709\u53EF\u80FD\uFF0CDataFrame \u4E2D\u7684\u5217\u5C31\u4F1A\u5728\u591A\u4E2A DataFrame \u4E4B\u95F4\u5171\u4EAB\uFF0C\u907F\u514D\u4E86\u76F8\u540C\u6570\u636E\u7684\u5185\u5B58\u91CD\u590D\u5360\u7528\u3002\u8FD9\u610F\u5473\u7740 DataFrame "),nn=n("code",null,"$a",-1),sn=s("\u548C"),an=n("code",null,"$a2",-1),en=s("\u5171\u4EAB\u6211\u4EEC\u7528 "),tn=n("code",null,"into df",-1),pn=s(" \u547D\u4EE4\u521B\u5EFA\u7684\u4E24\u4E2A\u5217\u3002\u7531\u4E8E\u8FD9\u4E2A\u539F\u56E0\uFF0C\u4E0D\u80FD\u6539\u53D8 DataFrame \u4E2D\u67D0\u4E00\u5217\u7684\u503C\u3002\u7136\u800C\uFF0C\u4F60\u53EF\u4EE5\u6839\u636E\u5176\u4ED6\u5217\u6216 DataFrame \u7684\u6570\u636E\u521B\u5EFA\u65B0\u7684\u5217\u3002"),on=t(`<h2 id="\u4F7F\u7528\u7CFB\u5217" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528\u7CFB\u5217" aria-hidden="true">#</a> \u4F7F\u7528\u7CFB\u5217</h2><p>\u7CFB\u5217(<code>Series</code>) \u662F <code>DataFrame</code> \u7684\u57FA\u672C\u7EC4\u6210\u90E8\u5206\u3002\u6BCF\u4E2A\u7CFB\u5217\u4EE3\u8868\u4E00\u4E2A\u5177\u6709\u76F8\u540C\u6570\u636E\u7C7B\u578B\u7684\u5217\uFF0C\u6211\u4EEC\u53EF\u4EE5\u521B\u5EFA\u591A\u4E2A\u4E0D\u540C\u7C7B\u578B\u7684\u7CFB\u5217\uFF0C\u5982\u6D6E\u70B9\u3001\u6574\u578B\u6216\u5B57\u7B26\u4E32\u3002</p><p>\u8BA9\u6211\u4EEC\u901A\u8FC7\u4F7F\u7528 <code>into df</code> \u547D\u4EE4\u521B\u5EFA\u4E00\u4E2A\u7CFB\u5217\uFF0C\u6765\u5F00\u59CB\u6211\u4EEC\u5BF9\u7CFB\u5217\u7684\u63A2\u7D22\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> new <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">9</span> <span class="token number">8</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">|</span> into <span class="token function">df</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> <span class="token variable">$new</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500
 <span class="token comment"># \u2502 0</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 <span class="token number">9</span>
 <span class="token number">1</span> \u2502 <span class="token number">8</span>
 <span class="token number">2</span> \u2502 <span class="token number">4</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500
</code></pre></div><p>\u6211\u4EEC\u4ECE\u4E00\u4E2A\u6574\u6570\u5217\u8868\u521B\u5EFA\u4E86\u4E00\u4E2A\u65B0\u7684\u7CFB\u5217\uFF08\u6211\u4EEC\u4E5F\u53EF\u4EE5\u7528\u6D6E\u70B9\u6570\u6216\u5B57\u7B26\u4E32\u505A\u540C\u6837\u7684\u4E8B\u60C5\uFF09\u3002</p><p>\u7CFB\u5217\u5DF2\u7ECF\u5B9A\u4E49\u4E86\u81EA\u5DF1\u7684\u57FA\u672C\u64CD\u4F5C\uFF0C\u5B83\u4EEC\u53EF\u4EE5\u7528\u6765\u521B\u5EFA\u5176\u4ED6\u7CFB\u5217\u3002\u8BA9\u6211\u4EEC\u901A\u8FC7\u5BF9\u5148\u524D\u521B\u5EFA\u7684\u5217\u8FDB\u884C\u4E00\u4E9B\u8FD0\u7B97\u6765\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\u7CFB\u5217\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> new_2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$new</span> * <span class="token number">3</span> + <span class="token number">10</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> <span class="token variable">$new_2</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 0</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 <span class="token number">37</span>
 <span class="token number">1</span> \u2502 <span class="token number">34</span>
 <span class="token number">2</span> \u2502 <span class="token number">22</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500
</code></pre></div><p>\u73B0\u5728\u6211\u4EEC\u6709\u4E00\u4E2A\u65B0\u7684\u7CFB\u5217\uFF0C\u5B83\u662F\u901A\u8FC7\u5BF9\u524D\u4E00\u4E2A\u53D8\u91CF\u8FDB\u884C\u57FA\u672C\u64CD\u4F5C\u800C\u6784\u5EFA\u7684\u3002</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>\u5982\u679C\u4F60\u60F3\u770B\u770B\u4F60\u5728\u5185\u5B58\u4E2D\u5B58\u50A8\u4E86\u591A\u5C11\u53D8\u91CF\uFF0C\u4F60\u53EF\u4EE5\u4F7F\u7528<code>$nu.scope.vars</code>\u3002</p></div><p>\u8BA9\u6211\u4EEC\u91CD\u65B0\u547D\u540D\u6211\u4EEC\u4E4B\u524D\u7684\u7CFB\u5217\u4E3A <code>memorable</code></p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> new_2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$new_2</span> <span class="token operator">|</span> <span class="token function">rename</span> <span class="token string">&quot;0&quot;</span> memorable<span class="token punctuation">)</span>
<span class="token operator">&gt;</span> <span class="token variable">$new_2</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 memorable</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502        <span class="token number">37</span>
 <span class="token number">1</span> \u2502        <span class="token number">34</span>
 <span class="token number">2</span> \u2502        <span class="token number">22</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u53EA\u8981\u4E24\u4E2A\u7CFB\u5217\u7684\u6570\u636E\u7C7B\u578B\u76F8\u540C\uFF0C\u6211\u4EEC\u4E5F\u53EF\u4EE5\u5BF9\u5B83\u4EEC\u8FDB\u884C\u57FA\u672C\u64CD\u4F5C\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token variable">$new</span> - <span class="token variable">$new_2</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 sub_0_0</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502     <span class="token parameter variable">-28</span>
 <span class="token number">1</span> \u2502     <span class="token parameter variable">-26</span>
 <span class="token number">2</span> \u2502     <span class="token parameter variable">-18</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u800C\u4E14\u6211\u4EEC\u53EF\u4EE5\u5C06\u5B83\u4EEC\u6DFB\u52A0\u5230\u5148\u524D\u5B9A\u4E49\u7684 DataFrames \u4E2D\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> new_df <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token operator">|</span> with-column <span class="token variable">$new</span> <span class="token parameter variable">--name</span> new_col<span class="token punctuation">)</span>
<span class="token operator">&gt;</span> <span class="token variable">$new_df</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 b \u2502 a \u2502 new_col</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 <span class="token number">2</span> \u2502 <span class="token number">1</span> \u2502       <span class="token number">9</span>
 <span class="token number">1</span> \u2502 <span class="token number">4</span> \u2502 <span class="token number">3</span> \u2502       <span class="token number">8</span>
 <span class="token number">2</span> \u2502 <span class="token number">6</span> \u2502 <span class="token number">5</span> \u2502       <span class="token number">4</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u5B58\u50A8\u5728 DataFrame \u4E2D\u7684\u7CFB\u5217\u4E5F\u53EF\u4EE5\u76F4\u63A5\u4F7F\u7528\uFF0C\u4F8B\u5982\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5C06\u5217<code>a</code>\u548C<code>b</code>\u76F8\u4E58\u6765\u521B\u5EFA\u4E00\u4E2A\u65B0\u7CFB\u5217\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token variable">$new_df</span>.a * <span class="token variable">$new_df</span>.b

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 mul_a_b</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502       <span class="token number">2</span>
 <span class="token number">1</span> \u2502      <span class="token number">12</span>
 <span class="token number">2</span> \u2502      <span class="token number">30</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u6211\u4EEC\u53EF\u4EE5\u5F00\u59CB\u4F7F\u7528\u7BA1\u9053\uFF0C\u4EE5\u521B\u5EFA\u65B0\u7684\u5217\u548C DataFrames\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> <span class="token variable">$new_df</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$new_df</span> <span class="token operator">|</span> with-column <span class="token punctuation">(</span><span class="token variable">$new_df</span>.a * <span class="token variable">$new_df</span>.b / <span class="token variable">$new_df</span>.new_col<span class="token punctuation">)</span> <span class="token parameter variable">--name</span> my_sum<span class="token punctuation">)</span>
<span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> <span class="token variable">$new_df</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 b \u2502 a \u2502 new_col \u2502 my_sum</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 <span class="token number">2</span> \u2502 <span class="token number">1</span> \u2502       <span class="token number">9</span> \u2502      <span class="token number">0</span>
 <span class="token number">1</span> \u2502 <span class="token number">4</span> \u2502 <span class="token number">3</span> \u2502       <span class="token number">8</span> \u2502      <span class="token number">1</span>
 <span class="token number">2</span> \u2502 <span class="token number">6</span> \u2502 <span class="token number">5</span> \u2502       <span class="token number">4</span> \u2502      <span class="token number">7</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>Nushell \u7684\u7BA1\u9053\u7CFB\u7EDF\u53EF\u4EE5\u5E2E\u52A9\u4F60\u521B\u5EFA\u975E\u5E38\u6709\u8DA3\u7684\u5DE5\u4F5C\u6D41\u7A0B\u3002</p><h2 id="\u7CFB\u5217\u548C\u63A9\u7801" tabindex="-1"><a class="header-anchor" href="#\u7CFB\u5217\u548C\u63A9\u7801" aria-hidden="true">#</a> \u7CFB\u5217\u548C\u63A9\u7801</h2><p>\u5728\u4F7F\u7528 DataFrames \u65F6\uFF0C\u7CFB\u5217\u8FD8\u6709\u53E6\u4E00\u4E2A\u5173\u952E\u7528\u9014\uFF0C\u90A3\u5C31\u662F\u6211\u4EEC\u53EF\u4EE5\u7528\u5B83\u4EEC\u6765\u5EFA\u7ACB\u5E03\u5C14\u63A9\u7801\uFF08Mask\uFF09\u3002\u8BA9\u6211\u4EEC\u5148\u7528\u7B49\u4E8E\u8FD0\u7B97\u7B26\u521B\u5EFA\u4E00\u4E2A\u7B80\u5355\u7684\u63A9\u7801\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> mask <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$new</span> <span class="token operator">==</span> <span class="token number">8</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> <span class="token variable">$mask</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 new_col</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 <span class="token boolean">false</span>
 <span class="token number">1</span> \u2502 <span class="token boolean">true</span>
 <span class="token number">2</span> \u2502 <span class="token boolean">false</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u6709\u4E86\u8FD9\u4E2A\u63A9\u7801\uFF0C\u6211\u4EEC\u73B0\u5728\u53EF\u4EE5\u8FC7\u6EE4\u4E00\u4E2A DataFrame\uFF0C\u50CF\u8FD9\u6837\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token variable">$new_df</span> <span class="token operator">|</span> filter-with <span class="token variable">$mask</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 a \u2502 b \u2502 new_col \u2502 my_sum</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 <span class="token number">3</span> \u2502 <span class="token number">4</span> \u2502       <span class="token number">8</span> \u2502      <span class="token number">1</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u73B0\u5728\u6211\u4EEC\u6709\u4E00\u4E2A\u65B0\u7684 DataFrame\uFF0C\u5176\u4E2D\u53EA\u6709\u63A9\u7801\u4E3A\u771F\u7684\u503C\u3002</p><p>\u63A9\u7801\u4E5F\u53EF\u4EE5\u4ECE Nushell \u5217\u8868\u4E2D\u521B\u5EFA\uFF0C\u6BD4\u5982\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> mask1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>true <span class="token boolean">true</span> false<span class="token punctuation">]</span> <span class="token operator">|</span> into <span class="token function">df</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> <span class="token variable">$new_df</span> <span class="token operator">|</span> filter-with <span class="token variable">$mask1</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 a \u2502 b \u2502 new_col \u2502 my_sum</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 <span class="token number">1</span> \u2502 <span class="token number">2</span> \u2502       <span class="token number">9</span> \u2502      <span class="token number">0</span>
 <span class="token number">1</span> \u2502 <span class="token number">3</span> \u2502 <span class="token number">4</span> \u2502       <span class="token number">8</span> \u2502      <span class="token number">1</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u4E3A\u4E86\u521B\u5EFA\u590D\u6742\u7684\u63A9\u7801\uFF0C\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528<code>AND</code>\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token variable">$mask</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$mask1</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 and_new_col_mask</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 <span class="token boolean">false</span>
 <span class="token number">1</span> \u2502 <span class="token boolean">true</span>
 <span class="token number">2</span> \u2502 <span class="token boolean">false</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u6216\u8005 <code>OR</code> \u64CD\u4F5C\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token variable">$mask</span> <span class="token operator">||</span> <span class="token variable">$mask1</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 or_new_col_mask</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 <span class="token boolean">true</span>
 <span class="token number">1</span> \u2502 <span class="token boolean">true</span>
 <span class="token number">2</span> \u2502 <span class="token boolean">false</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u6211\u4EEC\u4E5F\u53EF\u4EE5\u901A\u8FC7\u68C0\u67E5\u67D0\u4E9B\u503C\u662F\u5426\u5B58\u5728\u4E8E\u5176\u4ED6\u7CFB\u5217\u6765\u521B\u5EFA\u4E00\u4E2A\u63A9\u7801\u3002\u4F7F\u7528\u6211\u4EEC\u521B\u5EFA\u7684\u7B2C\u4E00\u4E2A DataFrame\uFF0C\u6211\u4EEC\u53EF\u4EE5\u8FD9\u6837\u505A\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> mask3 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$df</span>.first <span class="token operator">|</span> is-in <span class="token punctuation">(</span><span class="token punctuation">[</span>b c<span class="token punctuation">]</span> <span class="token operator">|</span> into <span class="token function">df</span><span class="token punctuation">))</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 first</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 <span class="token boolean">false</span>
 <span class="token number">1</span> \u2502 <span class="token boolean">false</span>
 <span class="token number">2</span> \u2502 <span class="token boolean">false</span>
 <span class="token number">3</span> \u2502 <span class="token boolean">true</span>
 <span class="token number">4</span> \u2502 <span class="token boolean">true</span>
 <span class="token number">5</span> \u2502 <span class="token boolean">true</span>
 <span class="token number">6</span> \u2502 <span class="token boolean">true</span>
 <span class="token number">7</span> \u2502 <span class="token boolean">true</span>
 <span class="token number">8</span> \u2502 <span class="token boolean">true</span>
 <span class="token number">9</span> \u2502 <span class="token boolean">true</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u800C\u8FD9\u4E2A\u65B0\u7684\u63A9\u7801\u53EF\u4EE5\u7528\u6765\u8FC7\u6EE4 DataFrame</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token variable">$df</span> <span class="token operator">|</span> filter-with <span class="token variable">$mask3</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 int_1 \u2502 int_2 \u2502 float_1 \u2502 float_2 \u2502 first \u2502 second \u2502 third \u2502  word</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502     <span class="token number">4</span> \u2502    <span class="token number">14</span> \u2502  <span class="token number">0.4000</span> \u2502  <span class="token number">3.0000</span> \u2502 b     \u2502 a      \u2502 c     \u2502 second
 <span class="token number">1</span> \u2502     <span class="token number">0</span> \u2502    <span class="token number">15</span> \u2502  <span class="token number">0.5000</span> \u2502  <span class="token number">4.0000</span> \u2502 b     \u2502 a      \u2502 a     \u2502 third
 <span class="token number">2</span> \u2502     <span class="token number">6</span> \u2502    <span class="token number">16</span> \u2502  <span class="token number">0.6000</span> \u2502  <span class="token number">5.0000</span> \u2502 b     \u2502 a      \u2502 a     \u2502 second
 <span class="token number">3</span> \u2502     <span class="token number">7</span> \u2502    <span class="token number">17</span> \u2502  <span class="token number">0.7000</span> \u2502  <span class="token number">6.0000</span> \u2502 b     \u2502 c      \u2502 a     \u2502 third
 <span class="token number">4</span> \u2502     <span class="token number">8</span> \u2502    <span class="token number">18</span> \u2502  <span class="token number">0.8000</span> \u2502  <span class="token number">7.0000</span> \u2502 c     \u2502 c      \u2502 b     \u2502 eight
 <span class="token number">5</span> \u2502     <span class="token number">9</span> \u2502    <span class="token number">19</span> \u2502  <span class="token number">0.9000</span> \u2502  <span class="token number">8.0000</span> \u2502 c     \u2502 c      \u2502 b     \u2502 ninth
 <span class="token number">6</span> \u2502     <span class="token number">0</span> \u2502    <span class="token number">10</span> \u2502  <span class="token number">0.0000</span> \u2502  <span class="token number">9.0000</span> \u2502 c     \u2502 c      \u2502 b     \u2502 ninth
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u53E6\u4E00\u4E2A\u53EF\u4EE5\u7528\u63A9\u7801\u8FDB\u884C\u7684\u64CD\u4F5C\u662F\u8BBE\u7F6E\u6216\u66FF\u6362\u4E00\u4E2A\u7CFB\u5217\u7684\u503C\u3002\u4F8B\u5982\uFF0C\u6211\u4EEC\u53EF\u4EE5\u6539\u53D8\u5217<code>first</code>\u4E2D\u7684\u503C\uFF0C\u5982\u679C\u8BE5\u503C\u5305\u542B<code>a</code>\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token variable">$df</span>.first <span class="token operator">|</span> <span class="token builtin class-name">set</span> new <span class="token parameter variable">--mask</span> <span class="token punctuation">(</span><span class="token variable">$df</span>.first <span class="token operator">=~</span> a<span class="token punctuation">)</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 string</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 new
 <span class="token number">1</span> \u2502 new
 <span class="token number">2</span> \u2502 new
 <span class="token number">3</span> \u2502 b
 <span class="token number">4</span> \u2502 b
 <span class="token number">5</span> \u2502 b
 <span class="token number">6</span> \u2502 b
 <span class="token number">7</span> \u2502 c
 <span class="token number">8</span> \u2502 c
 <span class="token number">9</span> \u2502 c
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><h2 id="\u7CFB\u5217\u4F5C\u4E3A\u7D22\u5F15" tabindex="-1"><a class="header-anchor" href="#\u7CFB\u5217\u4F5C\u4E3A\u7D22\u5F15" aria-hidden="true">#</a> \u7CFB\u5217\u4F5C\u4E3A\u7D22\u5F15</h2><p>\u7CFB\u5217\u4E5F\u53EF\u4EE5\u4F5C\u4E3A\u8FC7\u6EE4 DataFrame \u7684\u4E00\u79CD\u65B9\u5F0F\uFF0C\u5C06\u5B83\u4EEC\u4F5C\u4E3A\u7D22\u5F15\u5217\u8868\u4F7F\u7528\u3002\u4F8B\u5982\uFF0C\u5047\u8BBE\u6211\u4EEC\u60F3\u4ECE\u539F\u59CB DataFrame \u4E2D\u83B7\u53D6\u7B2C1\u30014\u548C6\u884C\u3002\u9488\u5BF9\u8FD9\u4E00\u70B9\uFF0C\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528\u4EE5\u4E0B\u547D\u4EE4\u6765\u63D0\u53D6\u8FD9\u4E9B\u4FE1\u606F\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> indices <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span> <span class="token number">4</span> <span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">|</span> into <span class="token function">df</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> <span class="token variable">$df</span> <span class="token operator">|</span> take <span class="token variable">$indices</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 int_1 \u2502 int_2 \u2502 float_1 \u2502 float_2 \u2502 first \u2502 second \u2502 third \u2502  word</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502     <span class="token number">2</span> \u2502    <span class="token number">12</span> \u2502  <span class="token number">0.2000</span> \u2502  <span class="token number">1.0000</span> \u2502 a     \u2502 b      \u2502 c     \u2502 second
 <span class="token number">1</span> \u2502     <span class="token number">0</span> \u2502    <span class="token number">15</span> \u2502  <span class="token number">0.5000</span> \u2502  <span class="token number">4.0000</span> \u2502 b     \u2502 a      \u2502 a     \u2502 third
 <span class="token number">2</span> \u2502     <span class="token number">7</span> \u2502    <span class="token number">17</span> \u2502  <span class="token number">0.7000</span> \u2502  <span class="token number">6.0000</span> \u2502 b     \u2502 c      \u2502 a     \u2502 third
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u547D\u4EE4 <code>take</code> \u975E\u5E38\u65B9\u4FBF\uFF0C\u7279\u522B\u662F\u5F53\u6211\u4EEC\u628A\u5B83\u4E0E\u5176\u4ED6\u547D\u4EE4\u6DF7\u5408\u4F7F\u7528\u65F6\u3002 \u5047\u8BBE\u6211\u4EEC\u60F3\u63D0\u53D6 <code>first</code> \u5217\u4E2D\u542B\u6709\u7B2C\u4E00\u4E2A\u91CD\u590D\u7684\u5143\u7D20\u7684\u7684\u6240\u6709\u8BB0\u5F55\u3002\u4E3A\u4E86\u505A\u5230\u8FD9\u4E00\u70B9\uFF0C\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528 <code>arg-unique</code> \u547D\u4EE4\uFF0C\u5982\u4E0B\u4F8B\u6240\u793A\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> indices <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$df</span>.first <span class="token operator">|</span> arg-unique<span class="token punctuation">)</span>
<span class="token operator">&gt;</span> <span class="token variable">$df</span> <span class="token operator">|</span> take <span class="token variable">$indices</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 int_1 \u2502 int_2 \u2502 float_1 \u2502 float_2 \u2502 first \u2502 second \u2502 third \u2502  word</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502     <span class="token number">1</span> \u2502    <span class="token number">11</span> \u2502  <span class="token number">0.1000</span> \u2502  <span class="token number">1.0000</span> \u2502 a     \u2502 b      \u2502 c     \u2502 first
 <span class="token number">1</span> \u2502     <span class="token number">4</span> \u2502    <span class="token number">14</span> \u2502  <span class="token number">0.4000</span> \u2502  <span class="token number">3.0000</span> \u2502 b     \u2502 a      \u2502 c     \u2502 second
 <span class="token number">2</span> \u2502     <span class="token number">8</span> \u2502    <span class="token number">18</span> \u2502  <span class="token number">0.8000</span> \u2502  <span class="token number">7.0000</span> \u2502 c     \u2502 c      \u2502 b     \u2502 eight
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u6216\u8005\uFF0C\u5982\u679C\u6211\u4EEC\u60F3\u4F7F\u7528\u4E00\u4E2A\u7279\u5B9A\u7684\u5217\u6765\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\u6709\u5E8F DataFrame\uFF0C\u8BE5\u600E\u4E48\u529E\uFF1F\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528<code>arg-sort</code>\u6765\u5B8C\u6210\u8FD9\u4E2A\u4EFB\u52A1\u3002\u5728\u4E0B\u4E00\u4E2A\u4F8B\u5B50\u4E2D\uFF0C\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7<code>word</code>\u5217\u5BF9 DataFrame \u8FDB\u884C\u6392\u5E8F\uFF1A</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>\u540C\u6837\u7684\u7ED3\u679C\u4E5F\u53EF\u4EE5\u7528<code>sort</code>\u547D\u4EE4\u6765\u5B8C\u6210\u3002</p></div><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> indices <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$df</span>.word <span class="token operator">|</span> arg-sort<span class="token punctuation">)</span>
<span class="token operator">&gt;</span> <span class="token variable">$df</span> <span class="token operator">|</span> take <span class="token variable">$indices</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 int_1 \u2502 int_2 \u2502 float_1 \u2502 float_2 \u2502 first \u2502 second \u2502 third \u2502  word</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502     <span class="token number">8</span> \u2502    <span class="token number">18</span> \u2502  <span class="token number">0.8000</span> \u2502  <span class="token number">7.0000</span> \u2502 c     \u2502 c      \u2502 b     \u2502 eight
 <span class="token number">1</span> \u2502     <span class="token number">1</span> \u2502    <span class="token number">11</span> \u2502  <span class="token number">0.1000</span> \u2502  <span class="token number">1.0000</span> \u2502 a     \u2502 b      \u2502 c     \u2502 first
 <span class="token number">2</span> \u2502     <span class="token number">9</span> \u2502    <span class="token number">19</span> \u2502  <span class="token number">0.9000</span> \u2502  <span class="token number">8.0000</span> \u2502 c     \u2502 c      \u2502 b     \u2502 ninth
 <span class="token number">3</span> \u2502     <span class="token number">0</span> \u2502    <span class="token number">10</span> \u2502  <span class="token number">0.0000</span> \u2502  <span class="token number">9.0000</span> \u2502 c     \u2502 c      \u2502 b     \u2502 ninth
 <span class="token number">4</span> \u2502     <span class="token number">2</span> \u2502    <span class="token number">12</span> \u2502  <span class="token number">0.2000</span> \u2502  <span class="token number">1.0000</span> \u2502 a     \u2502 b      \u2502 c     \u2502 second
 <span class="token number">5</span> \u2502     <span class="token number">4</span> \u2502    <span class="token number">14</span> \u2502  <span class="token number">0.4000</span> \u2502  <span class="token number">3.0000</span> \u2502 b     \u2502 a      \u2502 c     \u2502 second
 <span class="token number">6</span> \u2502     <span class="token number">6</span> \u2502    <span class="token number">16</span> \u2502  <span class="token number">0.6000</span> \u2502  <span class="token number">5.0000</span> \u2502 b     \u2502 a      \u2502 a     \u2502 second
 <span class="token number">7</span> \u2502     <span class="token number">3</span> \u2502    <span class="token number">13</span> \u2502  <span class="token number">0.3000</span> \u2502  <span class="token number">2.0000</span> \u2502 a     \u2502 b      \u2502 c     \u2502 third
 <span class="token number">8</span> \u2502     <span class="token number">0</span> \u2502    <span class="token number">15</span> \u2502  <span class="token number">0.5000</span> \u2502  <span class="token number">4.0000</span> \u2502 b     \u2502 a      \u2502 a     \u2502 third
 <span class="token number">9</span> \u2502     <span class="token number">7</span> \u2502    <span class="token number">17</span> \u2502  <span class="token number">0.7000</span> \u2502  <span class="token number">6.0000</span> \u2502 b     \u2502 c      \u2502 a     \u2502 third
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u6700\u540E\uFF0C\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7\u5728\u6807\u8BB0\u7684\u7D22\u5F15\u4E2D\u8BBE\u7F6E\u4E00\u4E2A\u65B0\u503C\u6765\u521B\u5EFA\u65B0\u7684\u7CFB\u5217\u3002\u8BF7\u770B\u4E0B\u4E00\u6761\u547D\u4EE4\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> indices <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">|</span> into <span class="token function">df</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span> <span class="token variable">$df</span>.int_1 <span class="token operator">|</span> set-with-idx <span class="token number">123</span> <span class="token parameter variable">--indices</span> <span class="token variable">$indices</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 int_1</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502   <span class="token number">123</span>
 <span class="token number">1</span> \u2502     <span class="token number">2</span>
 <span class="token number">2</span> \u2502   <span class="token number">123</span>
 <span class="token number">3</span> \u2502     <span class="token number">4</span>
 <span class="token number">4</span> \u2502     <span class="token number">0</span>
 <span class="token number">5</span> \u2502     <span class="token number">6</span>
 <span class="token number">6</span> \u2502     <span class="token number">7</span>
 <span class="token number">7</span> \u2502     <span class="token number">8</span>
 <span class="token number">8</span> \u2502     <span class="token number">9</span>
 <span class="token number">9</span> \u2502     <span class="token number">0</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><h2 id="\u552F\u4E00\u503C" tabindex="-1"><a class="header-anchor" href="#\u552F\u4E00\u503C" aria-hidden="true">#</a> \u552F\u4E00\u503C</h2><p>\u53E6\u4E00\u4E2A\u53EF\u4EE5\u7528<code>Series</code>\u5B8C\u6210\u7684\u64CD\u4F5C\u662F\u5728\u4E00\u4E2A\u5217\u8868\u6216\u5217\u4E2D\u641C\u7D22\u552F\u4E00\u503C\u3002\u8BA9\u6211\u4EEC\u518D\u6B21\u4F7F\u7528\u6211\u4EEC\u521B\u5EFA\u7684\u7B2C\u4E00\u4E2A DataFrame \u6765\u6D4B\u8BD5\u8FD9\u4E9B\u64CD\u4F5C\u3002</p><p>\u7B2C\u4E00\u4E2A\u4E5F\u662F\u6700\u5E38\u89C1\u7684\u64CD\u4F5C\u662F<code>value_counts</code>\u3002\u8FD9\u4E2A\u547D\u4EE4\u8BA1\u7B97\u51FA\u4E00\u4E2A\u7CFB\u5217\u4E2D\u5B58\u5728\u7684\u552F\u4E00\u503C\u7684\u6570\u91CF\u3002\u4F8B\u5982\uFF0C\u6211\u4EEC\u53EF\u4EE5\u7528\u5B83\u6765\u8BA1\u7B97 <code>first</code> \u5217\u5404\u503C\u7684\u51FA\u73B0\u6B21\u6570\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token variable">$df</span>.first <span class="token operator">|</span> value-counts

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 first \u2502 counts</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 b     \u2502      <span class="token number">4</span>
 <span class="token number">1</span> \u2502 c     \u2502      <span class="token number">3</span>
 <span class="token number">2</span> \u2502 a     \u2502      <span class="token number">3</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u6B63\u5982\u9884\u671F\u7684\u90A3\u6837\uFF0C\u8BE5\u547D\u4EE4\u8FD4\u56DE\u4E00\u4E2A\u65B0\u7684 DataFrame\uFF0C\u53EF\u4EE5\u7528\u6765\u505A\u66F4\u591A\u7684\u67E5\u8BE2\u3002</p><p>\u7EE7\u7EED\u6211\u4EEC\u5BF9 <code>Series</code> \u7684\u63A2\u7D22\uFF0C\u6211\u4EEC\u8981\u505A\u7684\u4E0B\u4E00\u4EF6\u4E8B\u662F\u53EA\u4ECE\u4E00\u4E2A\u7CFB\u5217\u4E2D\u83B7\u5F97\u552F\u4E00\u503C\uFF0C\u50CF\u8FD9\u6837\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token variable">$df</span>.first <span class="token operator">|</span> unique

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 first</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 c
 <span class="token number">1</span> \u2502 b
 <span class="token number">2</span> \u2502 a
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u6216\u8005\u6211\u4EEC\u53EF\u4EE5\u5F97\u5230\u4E00\u4E2A\u63A9\u7801\uFF0C\u7528\u6765\u8FC7\u6EE4\u51FA\u6570\u636E\u552F\u4E00\u6216\u91CD\u590D\u7684\u884C\u3002\u4F8B\u5982\uFF0C\u6211\u4EEC\u53EF\u4EE5\u9009\u62E9\u5217 <code>word</code> \u4E2D\u542B\u552F\u4E00\u503C\u7684\u884C\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token variable">$df</span> <span class="token operator">|</span> filter-with <span class="token punctuation">(</span><span class="token variable">$df</span>.word <span class="token operator">|</span> is-unique<span class="token punctuation">)</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 int_1 \u2502 int_2 \u2502 float_1 \u2502 float_2 \u2502 first \u2502 second \u2502 third \u2502 word</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502     <span class="token number">1</span> \u2502    <span class="token number">11</span> \u2502  <span class="token number">0.1000</span> \u2502  <span class="token number">1.0000</span> \u2502 a     \u2502 b      \u2502 c     \u2502 first
 <span class="token number">1</span> \u2502     <span class="token number">8</span> \u2502    <span class="token number">18</span> \u2502  <span class="token number">0.8000</span> \u2502  <span class="token number">7.0000</span> \u2502 c     \u2502 c      \u2502 b     \u2502 eight
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u6216\u6240\u6709\u542B\u91CD\u590D\u503C\u7684\u884C\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token variable">$df</span> <span class="token operator">|</span> filter-with <span class="token punctuation">(</span><span class="token variable">$df</span>.word <span class="token operator">|</span> is-duplicated<span class="token punctuation">)</span>

\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 int_1 \u2502 int_2 \u2502 float_1 \u2502 float_2 \u2502 first \u2502 second \u2502 third \u2502  word</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502     <span class="token number">2</span> \u2502    <span class="token number">12</span> \u2502  <span class="token number">0.2000</span> \u2502  <span class="token number">1.0000</span> \u2502 a     \u2502 b      \u2502 c     \u2502 second
 <span class="token number">1</span> \u2502     <span class="token number">3</span> \u2502    <span class="token number">13</span> \u2502  <span class="token number">0.3000</span> \u2502  <span class="token number">2.0000</span> \u2502 a     \u2502 b      \u2502 c     \u2502 third
 <span class="token number">2</span> \u2502     <span class="token number">4</span> \u2502    <span class="token number">14</span> \u2502  <span class="token number">0.4000</span> \u2502  <span class="token number">3.0000</span> \u2502 b     \u2502 a      \u2502 c     \u2502 second
 <span class="token number">3</span> \u2502     <span class="token number">0</span> \u2502    <span class="token number">15</span> \u2502  <span class="token number">0.5000</span> \u2502  <span class="token number">4.0000</span> \u2502 b     \u2502 a      \u2502 a     \u2502 third
 <span class="token number">4</span> \u2502     <span class="token number">6</span> \u2502    <span class="token number">16</span> \u2502  <span class="token number">0.6000</span> \u2502  <span class="token number">5.0000</span> \u2502 b     \u2502 a      \u2502 a     \u2502 second
 <span class="token number">5</span> \u2502     <span class="token number">7</span> \u2502    <span class="token number">17</span> \u2502  <span class="token number">0.7000</span> \u2502  <span class="token number">6.0000</span> \u2502 b     \u2502 c      \u2502 a     \u2502 third
 <span class="token number">6</span> \u2502     <span class="token number">9</span> \u2502    <span class="token number">19</span> \u2502  <span class="token number">0.9000</span> \u2502  <span class="token number">8.0000</span> \u2502 c     \u2502 c      \u2502 b     \u2502 ninth
 <span class="token number">7</span> \u2502     <span class="token number">0</span> \u2502    <span class="token number">10</span> \u2502  <span class="token number">0.0000</span> \u2502  <span class="token number">9.0000</span> \u2502 c     \u2502 c      \u2502 b     \u2502 ninth
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><h2 id="\u60F0\u6027-dataframe" tabindex="-1"><a class="header-anchor" href="#\u60F0\u6027-dataframe" aria-hidden="true">#</a> \u60F0\u6027 Dataframe</h2><p>\u60F0\u6027 Dataframe \u662F\u4E00\u79CD\u901A\u8FC7\u521B\u5EFA\u903B\u8F91\u8BA1\u5212\u6765\u67E5\u8BE2\u6570\u636E\u7684\u65B9\u6CD5\u3002\u8FD9\u79CD\u65B9\u6CD5\u7684\u4F18\u70B9\u662F\uFF0C\u5728\u4F60\u9700\u8981\u63D0\u53D6\u6570\u636E\u4E4B\u524D\uFF0C\u8BE5\u8BA1\u5212 \u6C38\u8FDC\u4E0D\u4F1A\u88AB\u8BC4\u4F30\u3002\u8FD9\u6837\uFF0C\u4F60\u53EF\u4EE5\u628A\u805A\u5408\u3001\u8FDE\u63A5\u548C\u9009\u62E9\u8FDE\u5728\u4E00\u8D77\uFF0C\u4E00\u65E6\u4F60\u5BF9\u6240\u9009\u64CD\u4F5C\u611F\u5230\u6EE1\u610F\uFF0C\u5C31\u53EF\u4EE5\u6536\u96C6\u6570\u636E\u3002</p><p>\u8BA9\u6211\u4EEC\u521B\u5EFA\u4E00\u4E2A\u60F0\u6027 Dataframe \u7684\u5C0F\u4F8B\u5B50\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span>a b<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">[</span><span class="token number">1</span> a<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">2</span> b<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">3</span> c<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">4</span> d<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">|</span> into lazy<span class="token punctuation">)</span>
<span class="token operator">&gt;</span> <span class="token variable">$a</span>
\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 plan           \u2502 DATAFRAME<span class="token punctuation">(</span>in-memory<span class="token punctuation">)</span>: <span class="token punctuation">[</span><span class="token string">&quot;a&quot;</span>, <span class="token string">&quot;b&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                \u2502     project */2 columns    <span class="token operator">|</span>    details: None<span class="token punctuation">;</span>
                \u2502     selection: <span class="token string">&quot;None&quot;</span>
 optimized_plan \u2502 DATAFRAME<span class="token punctuation">(</span>in-memory<span class="token punctuation">)</span>: <span class="token punctuation">[</span><span class="token string">&quot;a&quot;</span>, <span class="token string">&quot;b&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                \u2502     project */2 columns    <span class="token operator">|</span>    details: None<span class="token punctuation">;</span>
                \u2502     selection: <span class="token string">&quot;None&quot;</span>
\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u6B63\u5982\u4F60\u6240\u770B\u5230\u7684\uFF0C\u4EA7\u751F\u7684 Dataframe \u8FD8\u6CA1\u6709\u88AB\u8BC4\u4F30\uFF0C\u5B83\u4EE5\u4E00\u7EC4\u53EF\u4EE5\u5BF9\u6570\u636E\u8FDB\u884C\u64CD\u4F5C\u7684\u6307\u4EE4\u7684\u5F62\u5F0F\u5B58\u5728\u3002 \u5982\u679C\u4F60\u8981\u6536\u96C6\u8FD9\u4E2A Dataframe\uFF0C\u4F60\u4F1A\u5F97\u5230\u5982\u4E0B\u7ED3\u679C\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token variable">$a</span> <span class="token operator">|</span> collect
\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u252C\u2500\u2500\u2500
 <span class="token comment"># \u2502 a \u2502 b</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u253C\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 <span class="token number">1</span> \u2502 a
 <span class="token number">1</span> \u2502 <span class="token number">2</span> \u2502 b
 <span class="token number">2</span> \u2502 <span class="token number">3</span> \u2502 c
 <span class="token number">3</span> \u2502 <span class="token number">4</span> \u2502 d
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500
</code></pre></div><p>\u6B63\u5982\u4F60\u6240\u770B\u5230\u7684\uFF0C<code>collect</code> \u547D\u4EE4\u6267\u884C\u4E86\u8BA1\u5212\u5E76\u4E3A\u4F60\u521B\u5EFA\u4E86\u4E00\u4E2A Nushell \u8868\u3002</p><p>\u6240\u6709\u7684 Dataframe \u64CD\u4F5C\u90FD\u5E94\u8BE5\u80FD\u4E0E\u60F0\u6027\u6216\u8005\u975E\u60F0\u6027\u7684 Dataframe \u4E00\u8D77\u5DE5\u4F5C\u3002\u4E3A\u4E86\u517C\u5BB9\uFF0C\u8FD9\u4E9B\u64CD\u4F5C\u5728\u540E\u53F0 \u8FDB\u884C\u4E86\u8F6C\u6362\u3002\u7136\u800C\uFF0C\u4E3A\u4E86\u5229\u7528\u60F0\u6027\u64CD\u4F5C\u7684\u4F18\u52BF\uFF0C\u6211\u4EEC\u5EFA\u8BAE\u53EA\u5BF9\u60F0\u6027 Dataframe \u4F7F\u7528\u60F0\u6027\u64CD\u4F5C\u3002</p><p>\u8981\u627E\u5230\u6240\u6709\u60F0\u6027 Dataframe \u64CD\u4F5C\uFF0C\u4F60\u53EF\u4EE5\u4F7F\u7528\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token variable">$nu</span>.scope.commands <span class="token operator">|</span> where category <span class="token operator">=~</span> lazyframe
</code></pre></div><p>\u5728\u5B9A\u4E49\u4E86\u4F60\u7684\u60F0\u6027 Dataframe \u540E\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5F00\u59CB\u5BF9\u5B83\u8FDB\u884C\u94FE\u5F0F\u64CD\u4F5C\u3002\u4F8B\u5982\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token variable">$a</span>
:::   <span class="token operator">|</span> reverse
:::   <span class="token operator">|</span> with-column <span class="token punctuation">[</span>
:::      <span class="token punctuation">((</span>col a<span class="token punctuation">)</span> * <span class="token number">2</span> <span class="token operator">|</span> as double_a<span class="token punctuation">)</span>
:::      <span class="token punctuation">((</span>col a<span class="token punctuation">)</span> / <span class="token number">2</span> <span class="token operator">|</span> as half_a<span class="token punctuation">)</span>
:::   <span class="token punctuation">]</span>
:::   <span class="token operator">|</span> collect
\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 a \u2502 b \u2502 double_a \u2502 half_a</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 <span class="token number">4</span> \u2502 d \u2502        <span class="token number">8</span> \u2502      <span class="token number">2</span>
 <span class="token number">1</span> \u2502 <span class="token number">3</span> \u2502 c \u2502        <span class="token number">6</span> \u2502      <span class="token number">1</span>
 <span class="token number">2</span> \u2502 <span class="token number">2</span> \u2502 b \u2502        <span class="token number">4</span> \u2502      <span class="token number">1</span>
 <span class="token number">3</span> \u2502 <span class="token number">1</span> \u2502 a \u2502        <span class="token number">2</span> \u2502      <span class="token number">0</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>\u4F60\u53EF\u4EE5\u4F7F\u7528\u884C\u7F13\u5B58\u7F16\u8F91\u5668\u6765\u8F7B\u677E\u5730\u683C\u5F0F\u5316\u4F60\u7684\u67E5\u8BE2\uFF08ctr + o\uFF09</p></div><p>\u8FD9\u4E2A\u67E5\u8BE2\u4F7F\u7528\u60F0\u6027 <code>reverse</code> \u547D\u4EE4\u6765\u53CD\u8F6C Dataframe\uFF0C\u4F7F\u7528 <code>with-column</code> \u547D\u4EE4\u5E76\u4F7F\u7528 <code>expressions</code> \u6765\u521B\u5EFA\u65B0\u7684\u4E24\u5217\u3002 <code>expression</code> \u7528\u4E8E\u5B9A\u4E49\u5728\u60F0\u6027 Dataframe \u4E0A\u6267\u884C\u7684\u64CD\u4F5C\u3002\u5F53\u5B83\u4EEC\u7EC4\u5408\u5728\u4E00\u8D77\u65F6\uFF0C\u5C31\u5F62\u6210\u4E86\u6574\u4E2A\u7531\u60F0\u6027\u547D\u4EE4\u6765\u67E5\u8BE2\u6570\u636E\u7684 \u6307\u4EE4\u96C6\u3002\u8981\u5217\u51FA\u6240\u6709\u4EA7\u751F\u8868\u8FBE\u5F0F\u7684\u547D\u4EE4\uFF0C\u4F60\u53EF\u4EE5\u4F7F\u7528\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token variable">$nu</span>.scope.commands <span class="token operator">|</span> where category <span class="token operator">=~</span> expression
</code></pre></div><p>\u5728\u6211\u4EEC\u524D\u9762\u7684\u4F8B\u5B50\u4E2D\uFF0C\u6211\u4EEC\u4F7F\u7528 <code>col</code> \u547D\u4EE4\u6765\u8868\u793A\u5217 <code>a</code> \u5C06\u88AB\u4E58\u4EE52\uFF0C\u7136\u540E\u5B83\u5C06\u88AB\u547D\u540D\u4E3A <code>double_a</code>\u3002 \u5728\u67D0\u4E9B\u60C5\u51B5\u4E0B\uFF0C\u53EF\u4EE5\u63A8\u65AD\u51FA <code>col</code> \u547D\u4EE4\u7684\u4F7F\u7528\uFF0C\u4F8B\u5982\uFF0C\u4F7F\u7528 <code>select</code> \u547D\u4EE4\uFF0C\u6211\u4EEC\u53EF\u4EE5\u53EA\u4F7F\u7528\u4E00\u4E2A\u5B57\u7B26\u4E32\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token variable">$a</span> <span class="token operator">|</span> <span class="token keyword">select</span> a <span class="token operator">|</span> collect
</code></pre></div><p>\u6216\u8005\u4F7F\u7528 <code>col</code> \u547D\u4EE4\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token variable">$a</span> <span class="token operator">|</span> <span class="token keyword">select</span> <span class="token punctuation">(</span>col a<span class="token punctuation">)</span> <span class="token operator">|</span> collect
</code></pre></div><p>\u8BA9\u6211\u4EEC\u5C1D\u8BD5\u66F4\u590D\u6742\u7684\u4E1C\u897F\uFF0C\u4ECE\u4E00\u4E2A\u60F0\u6027 Dataframe \u4E2D\u521B\u5EFA\u805A\u5408\uFF1A</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> a <span class="token operator">=</span> <span class="token punctuation">(</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>name value<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">[</span>one <span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>two <span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>one <span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>two <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">|</span> into lazy <span class="token punctuation">)</span>
<span class="token operator">&gt;</span> <span class="token variable">$a</span>
:::   <span class="token operator">|</span> group-by name
:::   <span class="token operator">|</span> agg <span class="token punctuation">[</span>
:::       <span class="token punctuation">(</span>col value <span class="token operator">|</span> <span class="token function">sum</span> <span class="token operator">|</span> as <span class="token function">sum</span><span class="token punctuation">)</span>
:::       <span class="token punctuation">(</span>col value <span class="token operator">|</span> mean <span class="token operator">|</span> as mean<span class="token punctuation">)</span>
:::     <span class="token punctuation">]</span>
:::   <span class="token operator">|</span> collect
\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 name \u2502 sum \u2502 mean</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 two  \u2502   <span class="token number">5</span> \u2502 <span class="token number">2.50</span>
 <span class="token number">1</span> \u2502 one  \u2502   <span class="token number">2</span> \u2502 <span class="token number">1.00</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u6211\u4EEC\u53EF\u4EE5\u5728\u4E00\u4E2A\u8FD8\u6CA1\u6709\u88AB\u6536\u96C6\u7684\u60F0\u6027 Dataframe \u4E0A\u8FDB\u884C\u8FDE\u63A5\u64CD\u4F5C\u3002\u8BA9\u6211\u4EEC\u628A\u4EA7\u751F\u7684\u5206\u7EC4\u8FDE\u63A5\u5230\u539F\u6765\u7684\u60F0\u6027 Dataframe \u4E2D\u53BB\u5427</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> a <span class="token operator">=</span> <span class="token punctuation">(</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>name value<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">[</span>one <span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>two <span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>one <span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>two <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">|</span> into lazy <span class="token punctuation">)</span>
<span class="token operator">&gt;</span> <span class="token builtin class-name">let</span> group <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$a</span>
:::   <span class="token operator">|</span> group-by name
:::   <span class="token operator">|</span> agg <span class="token punctuation">[</span>
:::       <span class="token punctuation">(</span>col value <span class="token operator">|</span> <span class="token function">sum</span> <span class="token operator">|</span> as <span class="token function">sum</span><span class="token punctuation">)</span>
:::       <span class="token punctuation">(</span>col value <span class="token operator">|</span> mean <span class="token operator">|</span> as mean<span class="token punctuation">)</span>
:::     <span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> <span class="token variable">$a</span> <span class="token operator">|</span> <span class="token function">join</span> <span class="token variable">$group</span> name name <span class="token operator">|</span> collect
\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token comment"># \u2502 name \u2502 value \u2502 sum \u2502 mean</span>
\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u253C\u2500\u2500\u2500\u2500\u2500\u2500
 <span class="token number">0</span> \u2502 one  \u2502     <span class="token number">1</span> \u2502   <span class="token number">2</span> \u2502 <span class="token number">1.00</span>
 <span class="token number">1</span> \u2502 two  \u2502     <span class="token number">2</span> \u2502   <span class="token number">5</span> \u2502 <span class="token number">2.50</span>
 <span class="token number">2</span> \u2502 one  \u2502     <span class="token number">1</span> \u2502   <span class="token number">2</span> \u2502 <span class="token number">1.00</span>
 <span class="token number">3</span> \u2502 two  \u2502     <span class="token number">3</span> \u2502   <span class="token number">5</span> \u2502 <span class="token number">2.50</span>
\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500
</code></pre></div><p>\u6B63\u5982\u4F60\u6240\u770B\u5230\u7684\uFF0C\u60F0\u6027 Dataframe \u662F\u4E00\u4E2A\u5F3A\u5927\u7684\u7ED3\u6784\uFF0C\u5B83\u53EF\u4EE5\u8BA9\u4F60\u4F7F\u7528\u7075\u6D3B\u7684\u8BED\u6CD5\u6765\u67E5\u8BE2\u6570\u636E\uFF0C\u4ECE\u800C\u6781\u5FEB\u5730\u83B7\u5F97\u7ED3\u679C\u3002</p><h2 id="dataframe-\u547D\u4EE4" tabindex="-1"><a class="header-anchor" href="#dataframe-\u547D\u4EE4" aria-hidden="true">#</a> Dataframe \u547D\u4EE4</h2><p>\u5230\u76EE\u524D\u4E3A\u6B62\uFF0C\u6211\u4EEC\u5DF2\u7ECF\u770B\u5230\u4E86\u5F88\u591A\u53EF\u4EE5\u4F7F\u7528 <code>DataFrame</code> \u76F8\u5173\u547D\u4EE4\u7684\u64CD\u4F5C\u3002\u7136\u800C\uFF0C\u5230\u76EE\u524D\u4E3A\u6B62\uFF0C\u6211\u4EEC\u6240\u4F7F\u7528\u7684\u547D\u4EE4\u5E76\u4E0D\u5305\u62EC\u6240\u6709\u53EF\u7528\u6765\u5904\u7406\u6570\u636E\u7684\u547D\u4EE4\uFF0C\u8BF7\u653E\u5FC3\uFF0C\u968F\u7740\u8BE5\u529F\u80FD\u7684\u7A33\u5B9A\uFF0C\u8FD8\u4F1A\u6709\u66F4\u591A\u7684\u547D\u4EE4\u3002</p><p>\u4E0B\u8868\u5217\u51FA\u4E86\u53EF\u7528\u7684<code>DataFrame</code>\u547D\u4EE4\u53CA\u5176\u63CF\u8FF0\uFF0C\u5E76\u5C3D\u53EF\u80FD\u663E\u793A\u5176\u7C7B\u4F3C\u7684 Nushell \u547D\u4EE4\u3002</p><table><thead><tr><th>\u547D\u4EE4\u540D</th><th>\u5E94\u7528\u4E8E</th><th>\u63CF\u8FF0</th><th>Nushell \u7C7B\u4F3C\u547D\u4EE4</th></tr></thead><tbody><tr><td>aggregate</td><td>DataFrame, GroupBy, Series</td><td>\u5728\u4E00\u4E2A DataFrame\u3001GroupBy \u6216\u7CFB\u5217\u5BF9\u8C61\u4E0A\u6267\u884C\u805A\u5408\u64CD\u4F5C</td><td>math</td></tr><tr><td>all-false</td><td>Series</td><td>\u5982\u679C\u6240\u6709\u7684\u503C\u90FD\u662F\u5047\u7684\uFF0C\u5219\u8FD4\u56DE\u771F</td><td></td></tr><tr><td>all-true</td><td>Series</td><td>\u5982\u679C\u6240\u6709\u7684\u503C\u90FD\u662F\u771F\u7684\uFF0C\u5219\u8FD4\u56DE\u771F</td><td>all</td></tr><tr><td>arg-max</td><td>Series</td><td>\u8FD4\u56DE\u7CFB\u5217\u4E2D\u6700\u5927\u503C\u7684\u7D22\u5F15</td><td></td></tr><tr><td>arg-min</td><td>Series</td><td>\u8FD4\u56DE\u7CFB\u5217\u4E2D\u6700\u5C0F\u503C\u7684\u7D22\u5F15</td><td></td></tr><tr><td>arg-sort</td><td>Series</td><td>\u8FD4\u56DE\u6392\u5E8F\u540E\u7684\u7CFB\u5217\u7684\u7D22\u5F15</td><td></td></tr><tr><td>arg-true</td><td>Series</td><td>\u8FD4\u56DE\u503C\u4E3A\u771F\u7684\u7D22\u5F15</td><td></td></tr><tr><td>arg-unique</td><td>Series</td><td>\u8FD4\u56DE\u552F\u4E00\u503C\u7684\u7D22\u5F15</td><td></td></tr><tr><td>count-null</td><td>Series</td><td>\u8BA1\u7B97\u7A7A\u503C</td><td></td></tr><tr><td>count-unique</td><td>Series</td><td>\u8BA1\u7B97\u552F\u4E00\u503C</td><td></td></tr><tr><td>drop</td><td>DataFrame</td><td>\u901A\u8FC7\u5220\u9664\u9009\u5B9A\u7684\u5217\u6765\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684 DataFrame</td><td>drop</td></tr><tr><td>drop-duplicates</td><td>DataFrame</td><td>\u5220\u9664 DataFrame \u4E2D\u7684\u91CD\u590D\u503C</td><td></td></tr><tr><td>drop-nulls</td><td>DataFrame, Series</td><td>\u4E22\u5F03 DataFrame \u4E2D\u7684\u7A7A\u503C</td><td></td></tr><tr><td>dtypes</td><td>DataFrame</td><td>\u663E\u793A DataFrame \u7684\u6570\u636E\u7C7B\u578B</td><td></td></tr><tr><td>filter-with</td><td>DataFrame</td><td>\u4F7F\u7528 Mask \u4F5C\u4E3A\u53C2\u8003\u6765\u8FC7\u6EE4 DataFrame</td><td></td></tr><tr><td>first</td><td>DataFrame</td><td>\u7528\u7B2C\u4E00\u884C\u521B\u5EFA\u65B0\u7684 DataFrame</td><td>first</td></tr><tr><td>get</td><td>DataFrame</td><td>\u7528\u9009\u5B9A\u7684\u5217\u521B\u5EFA DataFrame</td><td>get</td></tr><tr><td>group-by</td><td>DataFrame</td><td>\u521B\u5EFA\u4E00\u4E2A GroupBy \u5BF9\u8C61\uFF0C\u53EF\u7528\u4E8E\u5176\u4ED6\u805A\u5408</td><td>group-by</td></tr><tr><td>is-duplicated</td><td>Series</td><td>\u521B\u5EFA\u8868\u793A\u91CD\u590D\u503C\u7684 Mask</td><td></td></tr><tr><td>is-in</td><td>Series</td><td>\u68C0\u67E5\u4E00\u4E2A\u7CFB\u5217\u7684\u5143\u7D20\u662F\u5426\u5305\u542B\u5728\u53F3\u8FB9\u7684\u7CFB\u5217\u4E2D</td><td>in</td></tr><tr><td>is-not-null</td><td>Series</td><td>\u521B\u5EFA\u503C\u4E3A\u975E\u7A7A\u7684 Mask</td><td></td></tr><tr><td>is-null</td><td>Series</td><td>\u521B\u5EFA\u503C\u4E3A\u7A7A\u7684 Mask</td><td><code>&lt;column_name&gt; == $nothing</code></td></tr><tr><td>is-unique</td><td>Series</td><td>\u521B\u5EFA\u8868\u793A\u552F\u4E00\u503C\u7684 Mask</td><td></td></tr><tr><td>join</td><td>DataFrame</td><td>\u4F7F\u7528\u5217\u4F5C\u4E3A\u53C2\u8003\u6765\u8FDE\u63A5\u4E00\u4E2A DataFrame</td><td></td></tr><tr><td>last</td><td>DataFrame</td><td>\u7528\u6700\u540E\u51E0\u884C\u521B\u5EFA\u65B0\u7684 DataFrame</td><td>last</td></tr><tr><td>ls-df</td><td></td><td>\u5217\u51FA\u5DF2\u5B58\u50A8\u7684 DataFrame</td><td></td></tr><tr><td>melt</td><td>DataFrame</td><td>\u5C06\u4E00\u4E2A DataFrame \u4ECE\u5BBD\u683C\u5F0F\u8F6C\u4E3A\u957F\u683C\u5F0F</td><td></td></tr><tr><td>not</td><td>Series Inverts boolean mask</td><td></td><td></td></tr><tr><td>open</td><td></td><td>\u4ECE csv \u6587\u4EF6\u4E2D\u52A0\u8F7D DataFrame</td><td>open</td></tr><tr><td>pivot</td><td>GroupBy</td><td>\u5728 GroupBy \u5BF9\u8C61\u4E0A\u6267\u884C\u900F\u89C6\u64CD\u4F5C</td><td>pivot</td></tr><tr><td>rename</td><td>Dataframe, Series</td><td>\u91CD\u547D\u540D\u4E00\u4E2A\u7CFB\u5217</td><td>rename</td></tr><tr><td>sample</td><td>DataFrame</td><td>\u521B\u5EFA\u6837\u672C DataFrame</td><td></td></tr><tr><td>select</td><td>DataFrame</td><td>\u7528\u9009\u5B9A\u7684\u5217\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684 DataFrame</td><td>select</td></tr><tr><td>set</td><td>Series</td><td>\u5728\u7ED9\u5B9A\u7684 Mask \u4E3A\u771F\u65F6\u8BBE\u7F6E\u503C</td><td></td></tr><tr><td>set-with-idx</td><td>Series</td><td>\u8BBE\u7F6E\u7ED9\u5B9A\u7D22\u5F15\u4E2D\u7684\u503C</td><td></td></tr><tr><td>shift</td><td>Series</td><td>\u5C06\u503C\u79FB\u5230\u4E00\u4E2A\u7ED9\u5B9A\u7684\u65F6\u6BB5</td><td></td></tr><tr><td>show</td><td>DataFrame</td><td>\u5C06 DataFrame \u7684\u4E00\u4E2A\u90E8\u5206\u8F6C\u6362\u4E3A\u4E00\u4E2A\u8868\u6216\u5217\u8868\u503C</td><td></td></tr><tr><td>slice</td><td>DataFrame</td><td>\u4ECE\u884C\u7684\u5207\u7247\u4E2D\u521B\u5EFA\u65B0\u7684 DataFrame</td><td></td></tr><tr><td>sort-by</td><td>DataFrame, Series</td><td>\u521B\u5EFA\u65B0\u7684\u6392\u5E8F DataFrame \u6216\u7CFB\u5217</td><td>sort</td></tr><tr><td>take</td><td>DataFrame, Series</td><td>\u4F7F\u7528\u7ED9\u5B9A\u7684\u7D22\u5F15\u521B\u5EFA\u65B0\u7684 DataFrame</td><td></td></tr><tr><td>to csv</td><td>DataFrame</td><td>\u5C06 DataFrame \u4FDD\u5B58\u4E3A csv \u6587\u4EF6</td><td>to csv</td></tr><tr><td>into df</td><td></td><td>\u5C06\u4E00\u4E2A\u7BA1\u9053\u91CC\u7684\u8868\u6216\u5217\u8868\u8F6C\u6362\u4E3A DataFrame</td><td></td></tr><tr><td>dummies</td><td>DataFrame</td><td>\u521B\u5EFA\u4E00\u4E2A\u5E26\u6709\u5047\u503C\u7684\u65B0 DataFrame</td><td></td></tr><tr><td>to parquet</td><td>DataFrame</td><td>\u5C06 DataFrame \u4FDD\u5B58\u5230 parquet \u6587\u4EF6\u4E2D</td><td></td></tr><tr><td>unique</td><td>Series</td><td>\u8FD4\u56DE\u4E00\u4E2A\u7CFB\u5217\u4E2D\u7684\u552F\u4E00\u503C</td><td>uniq</td></tr><tr><td>value-counts</td><td>Series</td><td>\u8FD4\u56DE\u4E00\u4E2A\u5E26\u6709\u7CFB\u5217\u4E2D\u552F\u4E00\u503C\u7684\u8BA1\u6570\u7684 DataFrame</td><td></td></tr><tr><td>where</td><td>DataFrame</td><td>\u8FC7\u6EE4 DataFrame \u4EE5\u7B26\u5408\u6761\u4EF6</td><td>where</td></tr><tr><td>with-column</td><td>DataFrame</td><td>\u5728 DataFrame \u4E2D\u6DFB\u52A0\u4E00\u4E2A\u7CFB\u5217</td><td><code>insert &lt;column_name&gt; &lt;value&gt; | upsert &lt;column_name&gt; { &lt;new_value&gt; }</code></td></tr></tbody></table><h2 id="dataframes-\u7684\u672A\u6765" tabindex="-1"><a class="header-anchor" href="#dataframes-\u7684\u672A\u6765" aria-hidden="true">#</a> DataFrames \u7684\u672A\u6765</h2><p>\u6211\u4EEC\u5E0C\u671B\u5728\u672C\u9875\u7ED3\u675F\u65F6\uFF0C\u4F60\u5DF2\u7ECF\u7262\u56FA\u638C\u63E1\u4E86\u5982\u4F55\u4F7F\u7528 DataFrame \u76F8\u5173\u547D\u4EE4\u3002\u6B63\u5982\u4F60\u6240\u770B\u5230\u7684\uFF0C\u5B83\u4EEC\u63D0\u4F9B\u4E86\u5F3A\u5927\u7684\u64CD\u4F5C\uFF0C\u53EF\u4EE5\u5E2E\u52A9\u4F60\u66F4\u5FEB\u66F4\u539F\u751F\u5730\u5904\u7406\u6570\u636E\u3002</p><p>\u7136\u800C\uFF0CDataFrames \u7684\u672A\u6765\u4ECD\u7136\u662F\u975E\u5E38\u5B9E\u9A8C\u6027\u7684\uFF0C\u968F\u7740\u8FD9\u4E9B\u547D\u4EE4\u7684\u6210\u719F\uFF0C\u65B0\u7684\u547D\u4EE4\u548C\u5229\u7528\u8FD9\u4E9B\u547D\u4EE4\u7684\u5DE5\u5177\u5C06\u88AB\u52A0\u5165\u3002\u4F8B\u5982\uFF0CDataFrames \u7684\u4E0B\u4E00\u6B65\u662F\u5F15\u5165\u60F0\u6027 DataFrames\uFF0C\u8FD9\u5C06\u5141\u8BB8\u4F60\u5B9A\u4E49\u590D\u6742\u7684\u6570\u636E\u64CD\u4F5C\uFF0C\u8FD9\u4E9B\u64CD\u4F5C\u5C06\u5728\u4F60\u51B3\u5B9A &quot;<strong>\u5B8C\u6210</strong>&quot; \u8FD9\u4E2A\u7BA1\u9053\u65F6\u624D\u88AB\u6267\u884C\u3002\u8FD9\u5C06\u4F7F Nushell \u6709\u673A\u4F1A\u9009\u62E9\u6700\u4F73\u8BA1\u5212\u6765\u67E5\u8BE2\u4F60\u6240\u8981\u6C42\u7684\u6570\u636E\u3002</p><p>\u8BF7\u7EE7\u7EED\u8BBF\u95EE\u672C\u4E66\uFF0C\u4EE5\u67E5\u770B DataFrames \u7684\u6700\u65B0\u60C5\u51B5\uFF0C\u4EE5\u53CA\u5B83\u4EEC\u5982\u4F55\u5E2E\u52A9\u4F60\u66F4\u5FEB\u66F4\u6709\u6548\u5730\u5904\u7406\u6570\u636E\u3002</p>`,91);function cn(ln,rn){const e=p("ExternalLinkIcon"),o=p("RouterLink");return l(),r("div",null,[d,n("p",null,[i,m,b,h,g,n("a",v,[_,a(e)]),f,n("a",D,[F,a(e)]),w,n("a",x,[$,a(e)]),y]),q,N,n("p",null,[S,n("a",A,[P,a(e)]),G,B,T]),I,z,n("p",null,[M,n("a",j,[O,a(e)]),C]),Y,n("p",null,[L,a(o,{to:"/book/commands/open.html"},{default:u(()=>[R]),_:1}),V]),E,n("p",null,[U,H,Z,J,K,n("a",Q,[W,a(e)]),X,nn,sn,an,en,tn,pn]),on])}const kn=c(k,[["render",cn],["__file","dataframes.html.vue"]]);export{kn as default};
