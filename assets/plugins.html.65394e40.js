import{_ as n,o as s,c as a,e as t}from"./app.8034769a.js";const p={},o=t(`<h1 id="plugins" tabindex="-1"><a class="header-anchor" href="#plugins" aria-hidden="true">#</a> Plugins</h1><h2 id="protocolo" tabindex="-1"><a class="header-anchor" href="#protocolo" aria-hidden="true">#</a> Protocolo</h2><p>Plugins usam JSON-RPC sobre stdin/stdout (de maneira parecida aos plugins do VSCode). O protocolo \xE9 dividido em dois est\xE1gios.</p><p>O primeiro est\xE1gio do protocolo lida com a descoberta inicial do plugin. Um plugin \xE9 iniciado e ent\xE3o solicitado para responder com a sua configura\xE7\xE3o. Muito semelhante aos comandos, plugins possuem uma assinatura que usam para responder ao Nu. Assim que o Nu possuir essa assinatura, ele saber\xE1 invocar o plugin futuramente.</p><p>O segundo est\xE1gio \xE9 a realiza\xE7\xE3o do verdadeiro trabalho. Aqui \xE9 enviado tanto uma stream de dados para o plugin agir em cada elemento como um filtro, ou ent\xE3o todos elementos de uma vez para o plugin agir em um processamento final como uma sa\xEDda.</p><h2 id="descoberta" tabindex="-1"><a class="header-anchor" href="#descoberta" aria-hidden="true">#</a> Descoberta</h2><p>Nu descobre plugins ao checar todos os diret\xF3rios dispon\xEDveis no PATH atual. Em cada diret\xF3rio, Nu busca por arquivos execut\xE1veis que combinam com o padr\xE3o <code>nu_plugin_*</code>, onde <code>*</code> \xE9 no m\xEDnimo um caracter alfanum\xE9rico. No Windows, isso \xE9 um padr\xE3o similar \xE0 <code>nu_plugin_*.exe</code> ou <code>nu_plugin_*.bat</code>.</p><p>Assim que um arquivo que combine com o padr\xE3o for descoberto, Nu vai invocar o arquivo e passar ao primeiro comando JSON-RPC: config. Config responde com a assinatura do plugin, que \xE9 id\xEAntico a assinatura usada por comandos.</p><p>Nu continua essa busca at\xE9 ter percorrido todos os diret\xF3rios no caminho.</p><p>Ap\xF3s ter percorrido o caminho, dois outros diret\xF3rios ser\xE3o verificados o diret\xF3rio alvo/debug e o diret\xF3rio alvo/release. Um ou outro diret\xF3rio vai ser buscado, dependendo seo Nu foi compilado no m\xF3do de depura\xE7\xE3o ou de release, respectivamente. Isso permite testar rapidamente os plugins durante o desenvolvimento.</p><h2 id="criando-um-plugin-em-rust" tabindex="-1"><a class="header-anchor" href="#criando-um-plugin-em-rust" aria-hidden="true">#</a> Criando um plugin (em Rust)</h2><p>Nessa se\xE7\xE3o, vamos mostrar como criar um plugin para o Nu usando Rust.</p><p>Vamos criar nosso projeto. Para esse exemplo, vamos criar um simples comando <code>len</code> que retorna o tamanho da string que recebe.</p><p>Primeiramente, vamos criar nosso plugin:</p><div class="language-text ext-text"><pre class="language-text"><code>&gt; cargo new nu_plugin_len
&gt; cd nu_plugin_len
</code></pre></div><p>Ent\xE3o, vamos adicionar <code>nu</code> na lista de depend\xEAncias do diret\xF3rio Cargo.toml. No final do novo arquivo Cargo.toml, adicione essa nova depend\xEAncia para o crate <code>nu</code>:</p><div class="language-text ext-text"><pre class="language-text"><code>[dependencies]
nu-plugin = &quot;~0&quot;
nu-protocol = &quot;~0&quot;
nu-source = &quot;~0&quot;
nu-errors = &quot;~0&quot;
</code></pre></div><p>Com isso, podemos abrir src/main.rs e criar nosso plugin.</p><div class="language-rust ext-rs"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">nu_errors<span class="token punctuation">::</span></span><span class="token class-name">ShellError</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">nu_plugin<span class="token punctuation">::</span></span><span class="token punctuation">{</span>serve_plugin<span class="token punctuation">,</span> <span class="token class-name">Plugin</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">nu_protocol<span class="token punctuation">::</span></span><span class="token punctuation">{</span>
    <span class="token class-name">CallInfo</span><span class="token punctuation">,</span> <span class="token class-name">Primitive</span><span class="token punctuation">,</span> <span class="token class-name">ReturnSuccess</span><span class="token punctuation">,</span> <span class="token class-name">ReturnValue</span><span class="token punctuation">,</span> <span class="token class-name">Signature</span><span class="token punctuation">,</span> <span class="token class-name">UntaggedValue</span><span class="token punctuation">,</span> <span class="token class-name">Value</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">Len</span><span class="token punctuation">;</span>

<span class="token keyword">impl</span> <span class="token class-name">Len</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Len</span> <span class="token punctuation">{</span>
        <span class="token class-name">Len</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">len</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token class-name">Value</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Value</span><span class="token punctuation">,</span> <span class="token class-name">ShellError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">match</span> <span class="token operator">&amp;</span>value<span class="token punctuation">.</span>value <span class="token punctuation">{</span>
            <span class="token class-name">UntaggedValue</span><span class="token punctuation">::</span><span class="token class-name">Primitive</span><span class="token punctuation">(</span><span class="token class-name">Primitive</span><span class="token punctuation">::</span><span class="token class-name">String</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">Value</span> <span class="token punctuation">{</span>
                value<span class="token punctuation">:</span> <span class="token class-name">UntaggedValue</span><span class="token punctuation">::</span><span class="token function">int</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">i64</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                tag<span class="token punctuation">:</span> value<span class="token punctuation">.</span>tag<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            _ <span class="token operator">=&gt;</span> <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token class-name">ShellError</span><span class="token punctuation">::</span><span class="token function">labeled_error</span><span class="token punctuation">(</span>
                <span class="token string">&quot;Unrecorgnized type in stream&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;&#39;len&#39; given non-string info by this&quot;</span><span class="token punctuation">,</span>
                value<span class="token punctuation">.</span>tag<span class="token punctuation">.</span>span<span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Plugin</span> <span class="token keyword">for</span> <span class="token class-name">Len</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">config</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Signature</span><span class="token punctuation">,</span> <span class="token class-name">ShellError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">Signature</span><span class="token punctuation">::</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token string">&quot;len&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token string">&quot;My custom len plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">begin_filter</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> _<span class="token punctuation">:</span> <span class="token class-name">CallInfo</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">ReturnValue</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">ShellError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> input<span class="token punctuation">:</span> <span class="token class-name">Value</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">ReturnValue</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">ShellError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token class-name">ReturnSuccess</span><span class="token punctuation">::</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">serve_plugin</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Len</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Existe bastante c\xF3digo at\xE9 aqui, ent\xE3o vamos verificar cada trecho separadamente.</p><p>Primeiramente, vamos olhar o main:</p><div class="language-rust ext-rs"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">serve_plugin</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Len</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>No main, simplesmente chamamos uma \xFAnica fun\xE7\xE3o <code>serve_plugin</code>. Isso vai fazer o trabalho de chamar o plugin, lidando com a serializa\xE7\xE3o/desserializa\xE7\xE3o do JSON, e enviando valores e erros de volta para o Nu. Para inici\xE1-lo, passamos algo que implementa a trait <code>Plugin</code>.</p><p>Em seguida, acima do main, est\xE1 a implementa\xE7\xE3o da trait <code>Plugin</code> para o nosso plugin em particular. Aqui, vamos implementar a trait Plugin para o nosso tipo, Len, que veremos em breve. Vamos ver como implementamos essa trait:</p><div class="language-rust ext-rs"><pre class="language-rust"><code><span class="token keyword">impl</span> <span class="token class-name">Plugin</span> <span class="token keyword">for</span> <span class="token class-name">Len</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">config</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Signature</span><span class="token punctuation">,</span> <span class="token class-name">ShellError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">Signature</span><span class="token punctuation">::</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token string">&quot;len&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token string">&quot;My custom len plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">begin_filter</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> _<span class="token punctuation">:</span> <span class="token class-name">CallInfo</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">ReturnValue</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">ShellError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> input<span class="token punctuation">:</span> <span class="token class-name">Value</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">ReturnValue</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">ShellError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token class-name">ReturnSuccess</span><span class="token punctuation">::</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>As duas partes mais importantes dessa implementa\xE7\xE3o s\xE3o a parte de <code>config</code>, que \xE9 executada pelo Nu quando se inicia pela primeira vez. Isso informa ao Nu as informa\xE7\xF5es b\xE1sicas sobre o plugin: nome, par\xE2metros recebidos, descri\xE7\xE3o e qual o tipo do plugin. Aqui, informamos ao Nu que o nome \xE9 &quot;len&quot;, damos uma b\xE1sica descri\xE7\xE3o de <code>ajuda</code> para mostrar e que somos um plugin de filtro (ao inv\xE9s de um plugin de sa\xEDda).</p><p>Em seguida, na implementa\xE7\xE3o do <code>filter</code>, descrevemos como as informa\xE7\xF5es s\xE3o processadas com o fluxo de dados neste plugin. Aqui, recebemos um valor (um <code>Value</code>) de cada vez. Tamb\xE9m retornamos ou um Vec de valores ou um erro. Retornar um vec ao inv\xE9s de um \xFAnico valor nos permite remover valores, ou adicionar outros, al\xE9m de trabalhar com o \xFAnico valor recebido.</p><p>J\xE1 que o <code>begin_filter</code> n\xE3o faz nada, podemos remove-lo. Isso simplificaria o c\xF3digo acima:</p><div class="language-rust ext-rs"><pre class="language-rust"><code><span class="token keyword">impl</span> <span class="token class-name">Plugin</span> <span class="token keyword">for</span> <span class="token class-name">Len</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">config</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Signature</span><span class="token punctuation">,</span> <span class="token class-name">ShellError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">Signature</span><span class="token punctuation">::</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token string">&quot;len&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token string">&quot;My custom len plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> input<span class="token punctuation">:</span> <span class="token class-name">Value</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">ReturnValue</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">ShellError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token class-name">ReturnSuccess</span><span class="token punctuation">::</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Se esse \xE9 o caso, por que temos um <code>begin_filter</code>? Vamos ver a assinatura do <code>begin_filter</code> mais pr\xF3ximo:</p><div class="language-rust ext-rs"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">begin_filter</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> _<span class="token punctuation">:</span> <span class="token class-name">CallInfo</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">ReturnValue</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">ShellError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Nosso comando <code>Len</code> n\xE3o requer nenhum par\xE2metro, mas caso precisasse esse seria o local para obt\xEA-los. A partir daqui, podemos configurar nosso filtro, e ent\xE3o usar isso com cada passo do comando <code>filter</code> sobre a entrada.</p><p>Vamos verificar o pr\xF3prio <code>Len</code> para ver o que ele est\xE1 fazendo:</p><div class="language-rust ext-rs"><pre class="language-rust"><code><span class="token keyword">struct</span> <span class="token type-definition class-name">Len</span><span class="token punctuation">;</span>

<span class="token keyword">impl</span> <span class="token class-name">Len</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Len</span> <span class="token punctuation">{</span>
        <span class="token class-name">Len</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">len</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token class-name">Value</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Value</span><span class="token punctuation">,</span> <span class="token class-name">ShellError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">match</span> <span class="token operator">&amp;</span>value<span class="token punctuation">.</span>value <span class="token punctuation">{</span>
            <span class="token class-name">UntaggedValue</span><span class="token punctuation">::</span><span class="token class-name">Primitive</span><span class="token punctuation">(</span><span class="token class-name">Primitive</span><span class="token punctuation">::</span><span class="token class-name">String</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">Value</span> <span class="token punctuation">{</span>
                value<span class="token punctuation">:</span> <span class="token class-name">UntaggedValue</span><span class="token punctuation">::</span><span class="token function">int</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">i64</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                tag<span class="token punctuation">:</span> value<span class="token punctuation">.</span>tag<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            _ <span class="token operator">=&gt;</span> <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token class-name">ShellError</span><span class="token punctuation">::</span><span class="token function">labeled_error</span><span class="token punctuation">(</span>
                <span class="token string">&quot;Unrecorgnized type in stream&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;&#39;len&#39; given non-string info by this&quot;</span><span class="token punctuation">,</span>
                value<span class="token punctuation">.</span>tag<span class="token punctuation">.</span>span<span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Criamos um <code>Len</code> muito simples, de fato, que n\xE3o tem nenhuma estrutura. Ao inv\xE9s disso \xE9 apenas um placeholder que vai permitir a implementa\xE7\xE3o do plugin.</p><p>Daqui, criamos dois m\xE9todos:</p><div class="language-rust ext-rs"><pre class="language-rust"><code><span class="token keyword">impl</span> <span class="token class-name">Len</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Len</span> <span class="token punctuation">{</span>
        <span class="token class-name">Len</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>O primeiro m\xE9todo \xE9 opcional: \xE9 apenas uma maneira conveniente de criar um novo valor do tipo <code>Len</code>. O verdadeiro trabalho \xE9 realizado no segundo m\xE9todo:</p><div class="language-rust ext-rs"><pre class="language-rust"><code><span class="token keyword">impl</span> <span class="token class-name">Len</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">len</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token class-name">Value</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Value</span><span class="token punctuation">,</span> <span class="token class-name">ShellError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">match</span> <span class="token operator">&amp;</span>value<span class="token punctuation">.</span>value <span class="token punctuation">{</span>
            <span class="token class-name">UntaggedValue</span><span class="token punctuation">::</span><span class="token class-name">Primitive</span><span class="token punctuation">(</span><span class="token class-name">Primitive</span><span class="token punctuation">::</span><span class="token class-name">String</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">Value</span> <span class="token punctuation">{</span>
                value<span class="token punctuation">:</span> <span class="token class-name">UntaggedValue</span><span class="token punctuation">::</span><span class="token function">int</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">i64</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                tag<span class="token punctuation">:</span> value<span class="token punctuation">.</span>tag<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            _ <span class="token operator">=&gt;</span> <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token class-name">ShellError</span><span class="token punctuation">::</span><span class="token function">labeled_error</span><span class="token punctuation">(</span>
                <span class="token string">&quot;Unrecorgnized type in stream&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;&#39;len&#39; given non-string info by this&quot;</span><span class="token punctuation">,</span>
                value<span class="token punctuation">.</span>tag<span class="token punctuation">.</span>span<span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Esse m\xE9todo age sobre cada elemento no pipeline que \xE9 recebido pelo nosso plugin. Para o nosso plugin, nos preocupamos apenas com strings para poder retornar o seu tamanho.</p><p>Usamos o pattern matching de Rust para verificar o tipo do Value recebido, e ent\xE3 poderando com ele caso seja uma string. O valor \xE9 um <code>Tagged&lt;Value&gt;</code>, ent\xE3o ele armazena com ele de onde o valor surgiu. Se o valor n\xE3o \xE9 um string, retornamos um erro e deixamos o usu\xE1rio saber de onde veio o valor que est\xE1 causando o problema. (Note que se quisessemos colocar um erro abaixo do nome do nome do comando, asta basta usar o <code>name_span</code> do CallInfo informado no <code>begin_filter</code>)</p><p>Por \xFAltimo, vamos ver o come\xE7o do arquivo:</p><div class="language-rust ext-rs"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">nu_errors<span class="token punctuation">::</span></span><span class="token class-name">ShellError</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">nu_plugin<span class="token punctuation">::</span></span><span class="token punctuation">{</span>serve_plugin<span class="token punctuation">,</span> <span class="token class-name">Plugin</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">nu_protocol<span class="token punctuation">::</span></span><span class="token punctuation">{</span>
    <span class="token class-name">CallInfo</span><span class="token punctuation">,</span> <span class="token class-name">Primitive</span><span class="token punctuation">,</span> <span class="token class-name">ReturnSuccess</span><span class="token punctuation">,</span> <span class="token class-name">ReturnValue</span><span class="token punctuation">,</span> <span class="token class-name">Signature</span><span class="token punctuation">,</span> <span class="token class-name">UntaggedValue</span><span class="token punctuation">,</span> <span class="token class-name">Value</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Aqui importamos tudo o que precisamos -- tipos e fun\xE7\xF5es -- para ser poss\xEDvel criar nosso plugin.</p><p>Assim que acabarmos nosso plugin s\xF3 precisamos instal\xE1-lo para us\xE1-lo.</p><div class="language-text ext-text"><pre class="language-text"><code>&gt; cargo install --path .
</code></pre></div><p>Assim que o <code>nu</code> iniciar, vai descobrir o plugin e registr\xE1-lo como um comando. Se voc\xEA j\xE1 estiver executando o <code>nu</code> durante o processo de instala\xE7\xE3o do seu plugin, tenha certeza de que voc\xEA reiniciou o <code>nu</code> para que possa carregar e registrar seu plugin.</p><div class="language-text ext-text"><pre class="language-text"><code>&gt; nu
&gt; echo hello | len
5
&gt; help len
This is my custom len plugin

Usage:
  &gt; len {flags}

flags:
  -h, --help: Display this help message
</code></pre></div><h2 id="criando-um-plugin-em-python" tabindex="-1"><a class="header-anchor" href="#criando-um-plugin-em-python" aria-hidden="true">#</a> Criando um plugin (em Python)</h2><p>Podemos tamb\xE9m criar plugins em outras linguagens de programa\xE7\xE3o. Nessa se\xE7\xE3o, vamos escrever o mesmo plugin <code>len</code> em Python.</p><p>Primeiramente, vamos verificar o plugin completo:</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/python3</span>
<span class="token keyword">import</span> json
<span class="token keyword">import</span> fileinput
<span class="token keyword">import</span> sys


<span class="token keyword">def</span> <span class="token function">print_good_response</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">:</span>
    json_response <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;jsonrpc&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2.0&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;method&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;response&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;params&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">&quot;Ok&quot;</span><span class="token punctuation">:</span> response<span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>json_response<span class="token punctuation">)</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">get_length</span><span class="token punctuation">(</span>string_value<span class="token punctuation">)</span><span class="token punctuation">:</span>
    string_len <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>string_value<span class="token punctuation">[</span><span class="token string">&quot;item&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;Primitive&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;String&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    int_item <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;Primitive&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">&quot;Int&quot;</span><span class="token punctuation">:</span> string_len<span class="token punctuation">}</span><span class="token punctuation">}</span>
    int_value <span class="token operator">=</span> string_value
    int_value<span class="token punctuation">[</span><span class="token string">&quot;item&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> int_item
    <span class="token keyword">return</span> int_value


<span class="token keyword">for</span> line <span class="token keyword">in</span> fileinput<span class="token punctuation">.</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    x <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>line<span class="token punctuation">)</span>
    method <span class="token operator">=</span> x<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;method&quot;</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> method <span class="token operator">==</span> <span class="token string">&quot;config&quot;</span><span class="token punctuation">:</span>
        config <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;len&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;usage&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Return the length of a string&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;positional&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;named&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;is_filter&quot;</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">}</span>
        print_good_response<span class="token punctuation">(</span>config<span class="token punctuation">)</span>
        <span class="token keyword">break</span>
    <span class="token keyword">elif</span> method <span class="token operator">==</span> <span class="token string">&quot;begin_filter&quot;</span><span class="token punctuation">:</span>
        print_good_response<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> method <span class="token operator">==</span> <span class="token string">&quot;filter&quot;</span><span class="token punctuation">:</span>
        int_item <span class="token operator">=</span> get_length<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token string">&quot;params&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        print_good_response<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&quot;Ok&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">&quot;Value&quot;</span><span class="token punctuation">:</span> int_item<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> method <span class="token operator">==</span> <span class="token string">&quot;end_filter&quot;</span><span class="token punctuation">:</span>
        print_good_response<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
</code></pre></div><p>Nota: existem maneiras de tornar Python mais robusto, mas aqui deixamos de maneira simples para ajudar com explica\xE7\xF5es.</p><p>Vamos verificar como o plugin funciona, de baixa para cima:</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">for</span> line <span class="token keyword">in</span> fileinput<span class="token punctuation">.</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    x <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>line<span class="token punctuation">)</span>
    method <span class="token operator">=</span> x<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;method&quot;</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> method <span class="token operator">==</span> <span class="token string">&quot;config&quot;</span><span class="token punctuation">:</span>
        config <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;len&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;usage&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Return the length of a string&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;positional&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;named&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;is_filter&quot;</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">}</span>
        print_good_response<span class="token punctuation">(</span>config<span class="token punctuation">)</span>
        <span class="token keyword">break</span>
    <span class="token keyword">elif</span> method <span class="token operator">==</span> <span class="token string">&quot;begin_filter&quot;</span><span class="token punctuation">:</span>
        print_good_response<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> method <span class="token operator">==</span> <span class="token string">&quot;filter&quot;</span><span class="token punctuation">:</span>
        int_item <span class="token operator">=</span> get_length<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token string">&quot;params&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        print_good_response<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&quot;Ok&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">&quot;Value&quot;</span><span class="token punctuation">:</span> int_item<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> method <span class="token operator">==</span> <span class="token string">&quot;end_filter&quot;</span><span class="token punctuation">:</span>
        print_good_response<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
</code></pre></div><p>Para esse plugin, temos que servir a fun\xE7\xE3o b\xE1sica: responder ao request da configura\xE7\xE3o do plugin a realizar o filtro. Esse c\xF3digo age como o loop principal, respondendo as mensagens do Nu realizando algum trabalho e ent\xE3o retornando uma resposta. Cada mensagem JSON \xE9 enviada para o plugin em uma \xFAnica linha, ent\xE3o \xE9 necess\xE1rio apenas ler a linha e realizar a interpreta\xE7\xE3o do JSON contido.</p><p>A partir disso, vemos qual m\xE9todo \xE9 invocado. Para esse plugin, existem quatro m\xE9todos que nos preocupamos: config, begin_filter, filter, e end_filter. Quando recebemos um request do tipo &#39;config&#39;, respondemos com a assinatura desse plugin, que \xE9 um peda\xE7o de informa\xE7\xE3o dizendo ao Nu como o comando deve ser chamado. Assim que for enviado, sa\xEDmos do loop para que o plugin possa encerrar e ser invocado novamente quando o filtro iniciar.</p><p>Os outros tr\xEAs m\xE9todos -- begin_filter, filter, e end_filter -- trabalham todos juntos para filtrar os dados recebidos. Como esse plugin vai trabalhar separadamente com cada peda\xE7o de dado, transformando strings nos seus respectivos tamanhos, fazemos a maior parte do nosso trabalho no m\xE9todo <code>filter</code>. O m\xE9todo &#39;end_filter&#39; \xE9 usado para encerrar o plugin, ent\xE3o usamos ele para sair do loop.</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_length</span><span class="token punctuation">(</span>string_value<span class="token punctuation">)</span><span class="token punctuation">:</span>
    string_len <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>string_value<span class="token punctuation">[</span><span class="token string">&quot;item&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;Primitive&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;String&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    int_item <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;Primitive&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">&quot;Int&quot;</span><span class="token punctuation">:</span> string_len<span class="token punctuation">}</span><span class="token punctuation">}</span>
    int_value <span class="token operator">=</span> string_value
    int_value<span class="token punctuation">[</span><span class="token string">&quot;item&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> int_item
    <span class="token keyword">return</span> int_value
</code></pre></div><p>A filtragem \xE9 realizada pela fun\xE7\xE3o <code>get_length</code>. Aqui, assumimos que estamos recebendo strings (podemos fazer esse m\xE9todo mais robusto futuramente e retornar um erro caso o par\xE2metro n\xE3o seja uma string), e ent\xE3o extra\xEDmos a string recebida. A partir disso, medimos o tamanho da string e criamos um novo <code>Int</code> para esse tamanho.</p><p>Finalmente, usamos o mesmo item recebido e o substituimos o payload com esse novo Int. Fazemos isso para reutilizar os metadados que passamos junto com a string recebida, apesar de isso ser um passo opcional. Poder\xEDamos ter optado por criar novos metadados e pass\xE1-los como resposta.</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">print_good_response</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">:</span>
    json_response <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;jsonrpc&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2.0&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;method&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;response&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;params&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">&quot;Ok&quot;</span><span class="token punctuation">:</span> response<span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>json_response<span class="token punctuation">)</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>Cada resposta do plugin para o Nu \xE9 tamb\xE9m uma mensagem em JSON que \xE9 enviada em uma \xFAnica linha. Convertemos essa resposta para JSON e enviamos com essa fun\xE7\xE3o auxiliar.</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">import</span> json
<span class="token keyword">import</span> fileinput
<span class="token keyword">import</span> sys
</code></pre></div><p>Tudo isso requer alguns imports para suceder, ent\xE3o vamos ter certeza de inclu\xED-los.</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/python3</span>
</code></pre></div><p>Finalmente, para facilitar a execu\xE7\xE3o de Python, torne esse arquivo execut\xE1vel (usando algo como <code>chmod +x nu_plugin_len</code>) e adicione o caminho para o nosso python no topo. Esse truque funciona para plataformas baseadas em Unix, mas para Windows vamos precisar criar um .exe ou .bat que vai invocar o python para n\xF3s.</p><p>Utilizamos Python 3 pois Python 2 n\xE3o vai mais ser mantido ap\xF3s 2020. Entretanto, scripts funcionam em ambas as vers\xF5es. Apenas mude a primeira linha da seguinte forma:</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/python</span>
</code></pre></div><p>e voc\xEA j\xE1 pode utilizar.</p><h2 id="criando-um-plugin-em-c" tabindex="-1"><a class="header-anchor" href="#criando-um-plugin-em-c" aria-hidden="true">#</a> Criando um plugin (em C#)</h2><p>Voc\xEA pode aprender mais sobre criar um plugin de Nu com C# aqui:</p><ul><li>.Net Core nu-plugin-lib: (https://github.com/myty/nu-plugin-lib)</li></ul>`,73),e=[o];function c(u,l){return s(),a("div",null,e)}const r=n(p,[["render",c],["__file","plugins.html.vue"]]);export{r as default};
